import { s, e, a } from '../index-9d8fa28c.js';
import { e as he, b as re, X as Xn, ao as Dn, t as te, r, Q as Qn, G as Gn, ap as Wn, H as Hn, aq as qn, S as Fn, K as Kn, ar as Ht, o, p as pe, n as rn$1, L as nn$1, as as un$1, a8 as zn, a3 as on$2, at as tn$1, an as en$1 } from '../json-rpc-bbea77b7.js';
import { R, g } from '../users-73981cf4.js';
import '../keysIn-f91c894f.js';
import { D as Dr, B as Bn, j as jr, b as On } from '../logging-23079156.js';
import { f, t, n, o as o$1 } from '../snippet-collections-86e7c592.js';
import '../content-scripts/destroy.js';
import { R as Ro, F as bo, m as mt, w as wt, G as ao, g as ni, I as Io, _ as _o, H as jo, M as mo, N as yo, P as ot, T as tt, U as et, V as Je, B as Bo, J as Jo, L as Lt, Y as Yn, Q as Qn$1, $ as vo, t as to, a0 as so, a1 as co, h as io, o as on$1, n as nn$2, u as un$2, p as Qo, a2 as $o, a3 as at, a4 as Eo, a5 as Qe, a6 as go, D as Ao, l as ln$1, a7 as it, a8 as Oo, a9 as oo, aa as no, O as Ot, S as St, ab as So, ac as Fo, ad as ho$1, ae as wo$1, af as Do, ag as Po, ah as Co$1, ai as ko$1, aj as xo$1, ak as Uo, al as ut, am as Ze, an as Ye, ao as Ge, ap as nt, aq as rt, ar as Mo, as as No$1 } from '../tracking-ba0776b8.js';
import { $ as $p, ag as Go, ah as zo, a9 as ho, ai as Ko, X as Xe, Y as nC, I as ro, aj as $r, ak as Zo, al as _o$1, q as Lo, E as No, am as qo, an as Gp, a0 as ko, B as Bp, ao as Dr$1, a7 as ao$1, p as jp, ap as zr, aq as Kr, C as Co, ar as to$1, as as qr, at as eo, A as dr, au as pr, av as fr, R as wo, b as bo$1, F as gr, aw as xo, V as Vr, h as hr, S as So$1, T as Po$1, ax as To, ay as Ro$1, az as Bo$1, aA as cf, aB as Xo } from '../content-ui-6b2a6ee6.js';
import '../src-match-utils-e7679468.js';
import { t as te$1, e as ee, n as ne, D as De } from '../expander-30141e13.js';
import '../content-scripts/autofill/autofill-forms.js';
import { c as ce, y as ye, B as Be, u as uL, m as me, w as we, X as XL, D as De$1, H as HC, p as pC, _ as _e, a as ue } from '../tag-utils-30396821.js';

const zt=["shared-ui-components/dialog.css","shared-ui-components/buttons.css"];function Jt(e){const{title:t,children:a,onCloseCallback:s,onChangeCallback:n,onSubmitCallback:o,showModal:r,allowClose:i}=e,[l,c]=nn$2(null),d=ln$1((e=>{c(e);}),[]);return on$1((()=>{if(l){if(r&&l.open||!r&&!l.open)return;r?l.showModal():l.close();}}),[r,l]),on$1((()=>{if(l){const e=e=>{e.preventDefault(),s&&s(e);},t=e=>{!1===i&&e.preventDefault();};return l.addEventListener("close",e),l.addEventListener("cancel",t),()=>{l.removeEventListener("close",e),l.removeEventListener("cancel",t);}}return ()=>{}}),[i,l,s]),mt(jp,{stylesheets:zt},mt("dialog",{onChange:n,ref:d},mt("form",{method:"dialog",onSubmit:o,onReset:s},!1!==i&&mt("button",{class:"actionable-icon close-dialog-button",type:"reset"},mt(ao$1,null)),!!t&&mt("h2",null,t),a)))}var Zt=s((function(e,t){e.exports=function(e,t){function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=a(e),n=a(t);function o(e){return s.default.createElement("button",{type:"button",className:e.classNames.selectedTag,title:e.removeButtonText,onClick:e.onDelete},s.default.createElement("span",{className:e.classNames.selectedTagName},e.tag.name))}var r={position:"absolute",width:0,height:0,visibility:"hidden",overflow:"scroll",whiteSpace:"pre"},i=["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform"],l=function(e){function t(t){e.call(this,t),this.state={inputWidth:null},this.input=s.default.createRef(),this.sizer=s.default.createRef();}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){this.props.autoresize&&(this.copyInputStyles(),this.updateInputWidth());},t.prototype.componentDidUpdate=function(e){var t=e.query,a=e.placeholderText;t===this.props.query&&a===this.props.placeholderText||this.updateInputWidth();},t.prototype.copyInputStyles=function(){var e=this,t=window.getComputedStyle(this.input.current);i.forEach((function(a){e.sizer.current.style[a]=t[a];}));},t.prototype.updateInputWidth=function(){var e;this.props.autoresize&&(e=Math.ceil(this.sizer.current.scrollWidth)+2),e!==this.state.inputWidth&&this.setState({inputWidth:e});},t.prototype.render=function(){var e=this.props,t=e.id,a=e.query,n=e.ariaLabelText,o=e.placeholderText,i=e.expanded,l=e.classNames,c=e.inputAttributes,d=e.inputEventHandlers,u=e.index;return s.default.createElement("div",{className:l.searchWrapper},s.default.createElement("input",Object.assign({},c,d,{ref:this.input,value:a,placeholder:o,className:l.searchInput,role:"combobox","aria-autocomplete":"list","aria-label":n||o,"aria-owns":t,"aria-activedescendant":u>-1?t+"-"+u:null,"aria-expanded":i,style:{width:this.state.inputWidth}})),s.default.createElement("div",{ref:this.sizer,style:r},a||o))},t}(s.default.Component);function c(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}function d(e){return new RegExp(c(e),"gi")}function u(e){return new RegExp("(?:^|\\s)"+c(e),"i")}function p(e){return new RegExp("^"+c(e)+"$","i")}function h(e,t){var a=d(t);return e.replace(a,"<mark>$&</mark>")}var g=function(e){var t=e.item,a=e.query;return s.default.createElement("span",{dangerouslySetInnerHTML:{__html:h(t.name,a)}})},m=function(e){function t(){e.apply(this,arguments);}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.onMouseDown=function(e,t){t.preventDefault(),this.props.addTag(e);},t.prototype.render=function(){var e=this;if(!this.props.expanded||!this.props.options.length)return null;var t=this.props.suggestionComponent||g,a=this.props.options.map((function(a,n){var o=e.props.id+"-"+n,r=[];return e.props.index===n&&r.push(e.props.classNames.suggestionActive),a.disabled&&r.push(e.props.classNames.suggestionDisabled),s.default.createElement("li",{id:o,key:o,role:"option",className:r.join(" "),"aria-disabled":!0===a.disabled,onMouseDown:e.onMouseDown.bind(e,a)},a.prefix?s.default.createElement("span",{className:e.props.classNames.suggestionPrefix},a.prefix," "):null,a.disableMarkIt?a.name:s.default.createElement(t,{item:a,query:e.props.query}))}));return s.default.createElement("div",{className:this.props.classNames.suggestions},s.default.createElement("ul",{role:"listbox",id:this.props.id},a))},t}(s.default.Component);function f(e,t){var a=e.querySelectorAll("a,button,input"),s=Array.prototype.findIndex.call(a,(function(e){return e===t})),n=a[s-1]||a[s+1];n&&n.focus();}var b={ENTER:"Enter",TAB:"Tab",BACKSPACE:"Backspace",UP_ARROW:"ArrowUp",UP_ARROW_COMPAT:"Up",DOWN_ARROW:"ArrowDown",DOWN_ARROW_COMPAT:"Down"},y={root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchWrapper:"react-tags__search-wrapper",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled",suggestionPrefix:"react-tags__suggestion-prefix"};function v(e,t){return e.findIndex((function(e){return p(t).test(e.name)}))}function C(){if(this.state.query.length>=this.props.minQueryLength){var e=v(this.state.options,this.state.query),t=-1===this.state.index?e:this.state.index,a=t>-1?this.state.options[t]:null;a?this.addTag(a):this.props.allowNew&&this.addTag({name:this.state.query});}}function w(e){e.preventDefault();var t=this.state.options.length-1;this.setState({index:this.state.index<=0?t:this.state.index-1});}function S(e){e.preventDefault();var t=this.state.options.length-1;this.setState({index:this.state.index>=t?0:this.state.index+1});}function x(){this.state.query.length||this.deleteTag(this.props.tags.length-1);}function k(e,t){return u(t).test(e.name)}function E(e,t){var a;return a=(a=e.suggestionsTransform?e.suggestionsTransform(t.query,e.suggestions):e.suggestions.filter((function(a){return e.suggestionsFilter(a,t.query)}))).slice(0,e.maxSuggestionsLength),e.allowNew?e.newTagText&&-1===v(a,t.query)&&a.push({id:0,name:t.query,prefix:e.newTagText,disableMarkIt:!0}):e.noSuggestionsText&&0===a.length&&a.push({id:0,name:e.noSuggestionsText,disabled:!0,disableMarkIt:!0}),a}var I=function(e){function t(t){e.call(this,t),this.state={query:"",focused:!1,index:-1},this.inputEventHandlers={onChange:function(){},onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onInput:this.onInput.bind(this),onKeyDown:this.onKeyDown.bind(this)},this.container=s.default.createRef(),this.input=s.default.createRef(),this.suggestions=s.default.createRef();}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.onInput=function(e){var t=e.target.value;this.props.onInput&&this.props.onInput(t),t.length===this.state.query.length+1&&this.props.delimiters.indexOf(t.slice(-1))>-1?C.call(this):t!==this.state.query&&this.setState({query:t});},t.prototype.onKeyDown=function(e){this.props.delimiters.indexOf(e.key)>-1&&((this.state.query||this.state.index>-1)&&e.preventDefault(),C.call(this)),e.key===b.BACKSPACE&&this.props.allowBackspace&&x.call(this,e),e.key!==b.UP_ARROW&&e.key!==b.UP_ARROW_COMPAT||w.call(this,e),e.key!==b.DOWN_ARROW&&e.key!==b.DOWN_ARROW_COMPAT||S.call(this,e);},t.prototype.onClick=function(e){document.activeElement!==e.target&&this.input.current.input.current.focus();},t.prototype.onBlur=function(){this.setState({focused:!1,index:-1}),this.props.onBlur&&this.props.onBlur(),this.props.addOnBlur&&C.call(this);},t.prototype.onFocus=function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus();},t.prototype.onDeleteTag=function(e,t){this.container.current&&f(this.container.current,t.currentTarget),this.deleteTag(e);},t.prototype.addTag=function(e){e.disabled||("function"!=typeof this.props.onValidate||this.props.onValidate(e))&&(this.props.onAddition({id:e.id,name:e.name}),this.clearInput());},t.prototype.deleteTag=function(e){this.props.onDelete(e);},t.prototype.clearInput=function(){this.setState({query:"",index:-1});},t.prototype.render=function(){var e=this,t=this.props.tagComponent||o,a=this.state.focused&&this.state.query.length>=this.props.minQueryLength,n=Object.assign({},y,this.props.classNames),r=[n.root];return this.state.focused&&r.push(n.rootFocused),s.default.createElement("div",{ref:this.container,className:r.join(" "),onClick:this.onClick.bind(this)},s.default.createElement("div",{className:n.selected,"aria-relevant":"additions removals","aria-live":"polite"},this.props.tags.map((function(a,o){return s.default.createElement(t,{key:o,tag:a,removeButtonText:e.props.removeButtonText,classNames:n,onDelete:e.onDeleteTag.bind(e,o)})}))),s.default.createElement("div",{className:n.search},s.default.createElement(l,Object.assign({},this.state,{id:this.props.id,ref:this.input,classNames:n,inputAttributes:this.props.inputAttributes,inputEventHandlers:this.inputEventHandlers,autoresize:this.props.autoresize,expanded:a,placeholderText:this.props.placeholderText,ariaLabelText:this.props.ariaLabelText})),s.default.createElement(m,Object.assign({},this.state,{id:this.props.id,ref:this.suggestions,classNames:n,expanded:a,addTag:this.addTag.bind(this),suggestionComponent:this.props.suggestionComponent}))))},t.getDerivedStateFromProps=function(e,t){return t.prevQuery!==t.query||t.prevSuggestions!==e.suggestions?{prevQuery:t.query,prevSuggestions:e.suggestions,options:E(e,t)}:null},t}(s.default.Component);return I.defaultProps={id:"ReactTags",tags:[],placeholderText:"Add new tag",removeButtonText:"Click to remove tag",noSuggestionsText:null,newTagText:null,suggestions:[],suggestionsFilter:k,suggestionsTransform:null,autoresize:!0,classNames:y,delimiters:[b.TAB,b.ENTER],minQueryLength:2,maxSuggestionsLength:6,allowNew:!1,allowBackspace:!0,addOnBlur:!1,tagComponent:null,suggestionComponent:null,inputAttributes:{}},I.propTypes={id:n.default.string,tags:n.default.arrayOf(n.default.object),placeholderText:n.default.string,ariaLabelText:n.default.string,removeButtonText:n.default.string,noSuggestionsText:n.default.string,newTagText:n.default.string,suggestions:n.default.arrayOf(n.default.object),suggestionsFilter:n.default.func,suggestionsTransform:n.default.func,autoresize:n.default.bool,delimiters:n.default.arrayOf(n.default.string),onDelete:n.default.func.isRequired,onAddition:n.default.func.isRequired,onInput:n.default.func,onFocus:n.default.func,onBlur:n.default.func,onValidate:n.default.func,minQueryLength:n.default.number,maxSuggestionsLength:n.default.number,classNames:n.default.object,allowNew:n.default.bool,allowBackspace:n.default.bool,addOnBlur:n.default.bool,tagComponent:n.default.oneOfType([n.default.func,n.default.element]),suggestionComponent:n.default.oneOfType([n.default.func,n.default.element]),inputAttributes:n.default.object},I}(Qn$1,Yn);}));const Kt=["/shared-ui-components/buttons.css","/shared-ui-components/copy-share-url-component.css"];function Gt(e){const{tracking:t,url:a}=e,[s,n]=nn$2(!0);return mt(jp,{stylesheets:Kt},mt("div",null,mt("span",{id:"share-copy-url"},mt("input",{value:a,readonly:!0}),mt("button",{id:"share-copy",type:"button",class:"actionable-icon",onClick:()=>{!function({url:e,tracking:t}){navigator.clipboard.writeText(e),ni(t);}({tracking:t,url:a}),n(!1);}},"Copy"))),mt("div",{class:"share-link-copied",hidden:s},"Link Copied"))}var Yt;function Qt(e){return mt("div",{class:"email-tag"},mt("span",null,e.tag.name),mt("button",{class:"actionable-icon",type:"reset",onClick:e.onDelete},mt(ao$1,null)))}function Xt(e){const t=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled)),[a,n]=nn$2([]),[o,r]=nn$2(Yt.None),i=St();let l=mt("div",{class:"share-shortcuts"},mt("h2",null,"Send to anyone!"),mt("p",null,"Your shortcut share link updates with these shortcut changes. People who download will not receive shortcut changes."),mt("p",null,mt("strong",null,"Magician’s tip:")," save this link as a shortcut to save time sharing again.",mt("br",null),mt("span",{id:"share-shortcuts-learn-link"},mt("a",{target:"_blank",href:"http://www.getmagical.com/help/sharing-shortcuts"},"Learn about sharing shortcuts"))),mt(zr,{displayQuantity:e.isShareShortcuts?.displayQuantity||"",label:e.isShareShortcuts?.label||""}));return t&&(l=mt(uL,null)),mt(jp,{stylesheets:["options/options.css","shared-ui-components/share-component.css","shared-ui-components/buttons.css"]},mt("div",{class:"share-content"},mt("div",{class:"share-left"},mt("h2",null,e.header),mt("h3",null,"Copy link"),mt(Gt,{url:e.shareUrl,tracking:e.copyUrlTracking}),mt("div",{class:"share-divider"},"or"),mt("h3",null,"Send by email"),mt("div",{class:"share-by-email-success",hidden:o!==Yt.EmailsSent},"🎉  Invites sent! 🎉"),mt("div",{id:"share-by-email-input",onClick:e=>{const t=i.current?.input?.current?.input?.current;t instanceof HTMLInputElement&&t.focus();}},mt(Zt,{ref:i,allowNew:!0,delimiters:["Enter","Tab"," ",";",","],autofocus:!0,tagComponent:Qt,tags:a,onAddition:e=>n(a.concat([e])),onDelete:e=>{a.splice(e,1),n([...a]);},onInput:e=>r(Yt.None),onValidate:e=>!!on$2(e.name)||(r(Yt.InvalidEmailAddress),!1),placeholderText:0===a.length?"Emails, comma separated":""})),mt("div",{class:"share-by-email-failure",hidden:o!==Yt.InvalidEmailAddress},"Invalid email"),mt("div",{class:"share-by-email-failure",hidden:o!==Yt.EmailsSentError},"Error sending emails"),mt("button",{type:"button",class:"button-medium primary",disabled:!a.length,onClick:async()=>{if(!a.length)return;await e.onSendEmailClick(a.map((e=>e.name)))?(n([]),r(Yt.EmailsSent)):r(Yt.EmailsSentError);}},"Send")),(t||e.isShareShortcuts)&&mt("div",{class:"share-right"},l)))}!function(e){e[e.None=0]="None",e[e.InvalidEmailAddress=1]="InvalidEmailAddress",e[e.EmailsSent=2]="EmailsSent",e[e.EmailsSentError=3]="EmailsSentError";}(Yt||(Yt={}));const ea=new he("shareByEmail"),ta=oo`
  dialog {
    min-width: 800px;
    background-color: var(--magical-gray-10);
  }
`,aa=new he("share-shortcuts-dialog");async function sa(e){return aa.request("saveSnippetCollection",{id:pe(),snippetIds:e,label:null})}function na(e){const{numSharedShortcuts:t,maybeReplaceCountWithAll:a}=e;return {number:a&&Ro.getState().optionsPage.saved.length===t?"all":t.toString(),label:tn$1("shortcut",t)}}function oa(){const e=to((e=>e.dialogs.shareShortcutsDialog)),t=to((e=>e.global.config.shareShortcutsUrl)),a=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled)),s=to((e=>e.global.userInfo.featureFlags.referralCreditsProBetaDefaultSequenceEnabled)),n=to((e=>e.global.userInfo.featureFlags.referralCreditsExperimentSequenceEnabled)),o=to((e=>e.global.referrals)),{shortcutIds:r$1,reshareCollectionId:l}=e,[c,d]=nn$2({url:"",collectionId:""}),[u,p]=nn$2(""),[h,g]=nn$2(""),m=l?"reshareShortcuts":"shareShortcuts";on$1((()=>{!async function(){try{let e,i;if(l)e=l,i=r$1.length;else {const t=await sa(r$1);e=t.id,i=t.snippetIds.length;}ni({type:"workspace.share.show",entryPoint:m,referralCount:o.length,collectionId:e,shortcutCount:i});const c=te$1(new URL(`${t}?shareId=${e}`),{referralCreditsEnabled:a,referralCreditsExperimentSequenceEnabled:n,referralCreditsProBetaDefaultSequenceEnabled:s}).toString();d({url:c,collectionId:e});const{number:u,label:h}=na({numSharedShortcuts:r$1.length,maybeReplaceCountWithAll:!0});p(u),g(h),Ro.dispatch(yo(r$1));}catch(e){En().textContent="Error sharing shortcuts. Please try again.",r.error(e);}}();}),[l,t,r$1,o.length,m,a,s,n]);let f="💪 Share 1 shortcut";return "1"!==u&&(f=`💪 Share ${u} shortcuts`),mt(Jt,{title:void 0,showModal:!0,onCloseCallback:()=>{Ro.dispatch(it());}},mt(wt,null,mt(io,{css:ta}),mt(Xt,{header:f,shareUrl:c.url,copyUrlTracking:{type:"workspace.share.copy",entryPoint:"shareShortcuts",referralCount:o.length},onSendEmailClick:async e=>{const t=await ea.request("shareShortcutsByEmail",{emails:e,collectionId:c.collectionId,utmCampaign:ee({referralCreditsEnabled:a,referralCreditsExperimentSequenceEnabled:n,referralCreditsProBetaDefaultSequenceEnabled:s})});return t&&ni({type:"workspace.share.email",entryPoint:m,referralCount:o.length,emailCount:e.length,shortcutCount:r$1.length,collectionId:c.collectionId}),t},isShareShortcuts:{displayQuantity:u,label:h}})))}const ra=new he("shortcut-utils");async function ia(e){try{const t=Object.values(await ra.request("getSnippets")),a=[],s=[],{unsavedInConflict:n}=Uo(t,e);let r=[];for(const n of e){let e=!0;for(const a of t){if(n.trigger===a.trigger){n.body===a.body&&s.push({sharedShortcutId:n.id,existingShortcutId:a.id}),e=!1;break}if(n.trigger.startsWith(a.trigger)||a.trigger.startsWith(n.trigger)){e=!1;break}}e&&a.push({id:pe(),trigger:n.trigger,body:n.body,parentId:n.id});}return n.length&&n.forEach((e=>Ro.dispatch(_o({snippet:e})))),a.length&&(r=await ra.request("saveSnippets",a)),{savedShortcuts:r,duplicateShortcuts:s,conflictedShortcuts:n}}catch(e){throw r.error(e),e}}const la=oo`
  .shared-shortcuts-container {
    align-items: flex-start;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: space-around;
    text-align: center;
  }

  .shortcuts-label-small-margins {
    margin: 0.75rem 0
  }

  #logged-in-shared-shortcuts-container {
    margin-right: 0.75rem;
  }

  .share-shortcuts-subtitle {
    text-align: left;
  }

  .shared-shortcuts-number {
    font-weight: 700;
    font-size: 48px;
    fill: var(--magical-gray-80);
  }

  .shared-shortcuts-label {
    font-weight: 400;
    fill: var(--magical-gray-60);
  }

  .receive-information {
    margin: 8px 0;
    padding: 0 4px;
  }

  .preview-container {
    padding: 4px 8px;
    background: #FDEAD9;
    border: 1px solid #FFE0B5;
    border-radius: 8px;
  }

  .preview-emoji {
    font-size: 3rem;
  }

  .preview-snippet {
    margin-bottom: 4px;
    padding: 4px 6px;
    max-width: 220px;
    display: flex;
    align-items: center;
    background: #D8DFE7;
    border-radius: 4px;
    font-size: 12px;
  }

  .preview-snippet-text {
    margin: 0;
  }

  .preview-snippet-text p {
    margin: 0;
  }
  
  .preview-truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-height: 3.4rem;
  }

  .preview-snippet-arrow {
    display: flex;
    margin: 0 6px;
  }

  .preview-trigger-text {
    font-weight: bold;
  }

  .body-field-readonly {
    border: none;
  }
`,ca=new he("receive-shortcuts-dialog"),da=new he("receive-shortcuts-dialog");async function ua(e){await a.browser.cookies.remove({name:"shareId",url:e});}async function pa(e,t,a){try{const s=await ca.request("getSharedSnippets",e),{savedShortcuts:n,duplicateShortcuts:o,conflictedShortcuts:r}=await ia(s);r.length&&(En().textContent=`${r.length} shared shortcuts' names conflicted with originals. Rename and save.`),n.length&&(xn().textContent=`Successfully saved ${n.length} shortcuts`),o.length&&(kn().textContent=`${o.length} shared shortcuts already existed. Originals were kept.`),ni({type:"ate_shareShortcuts_accept",collectionId:e,newCount:n.length,duplicateCount:o.length,conflictedCount:r.length}),await ua(a),(n.length||r.length||o.length)&&async function(e,t){if(!e)return;const{newShortcuts:a,duplicateShortcuts:s,conflictedShortcuts:n}=t;let o=function(e){let t="";return t=e.label?e.label:e.creatorUser?.firstName?`${e.creatorUser?.firstName} ${e.creatorUser?.lastName?.slice(0,1)||""}`.trim():"Shared",t}(e);const r=new RegExp(`^${o}(?:\\s{1}\\((\\d+)\\))?$`),i=me(r);if(i.length){o=`${o} (${i.map((e=>{const t=e.label?.match(r);return t&&t[1]?parseInt(t[1],10):0})).sort(((e,t)=>t-e))[0]+1})`;}const l=await we(o),c=s.map((e=>e.existingShortcutId)),d=a.map((e=>e.id)).concat(c);Be([l.id],d);const u=n.flatMap((e=>e.id));Ro.dispatch(Oo({snippetIds:u,collectionIds:[l.id]}));}(t,{newShortcuts:n,duplicateShortcuts:o,conflictedShortcuts:r}),da.notification("setUserChecklist",{acceptShortcuts:!0});}catch(e){En().textContent="Error saving received shortcuts. Please try again.";}}function ha(){const[e,t]=Qn$1.useState({}),[a,s]=Qn$1.useState(""),[n,o]=Qn$1.useState(""),[r$1,d]=Qn$1.useState(""),[u,p]=Qn$1.useState(!1),{config:{magicalMarketingURL:h},sharedCollectionId:g,userInfo:m}=to((e=>e.global)),f=!!m.email,b=!!g;Qn$1.useEffect((()=>{!async function(){var e,a;if(g)try{const n=await ca.request("getPublicSnippetCollection",g);t(n);const r=n.snippetIds.length,i=(e=n.creatorUser?.firstName,a=n.creatorUser?.lastName,e?`${e||""} ${a?.slice(0,1)||""}`.trim():"Someone");s(i);const{number:l,label:c}=na({numSharedShortcuts:n.snippetIds.length});o(l),d(c),ni({type:"ate_shareShortcuts_receive",collectionId:g,shortcutCount:r});}catch(e){p(!0),r.error(e);}}();}),[g]);const y=async()=>{await ua(h),p(!1);},v=async()=>{var t;f?(await pa(g,e,h),m.featureFlags.acceptCollectionEmailTrackingEnabled&&ca.notification("acceptSnippetCollection",g),y()):(t=!0,ni({type:"ate_signin"}),t?window.location.href=Dn:Ht(Dn));};if(0===e?.snippetIds?.length||u)return mt(Jt,{title:"You have found an outdated link!",showModal:b,onCloseCallback:()=>{y();}},mt(wt,null,mt(io,{css:la}),mt("div",{class:"shared-shortcuts-container"},mt("div",{id:"logged-in-shared-shortcuts-container"},mt("p",{class:"share-shortcuts-subtitle"},"Contact ","Someone"===a?"the owner":a||"the owner"," for the latest link or",mt("br",null)," ask them to generate a new one.")),mt(Kr,null))));const C=!(!e?.metadata?.emoji||!e?.highlightedSnippets?.length);return mt(Jt,{title:void 0,showModal:b,onCloseCallback:()=>{y();},onSubmitCallback:()=>{v();}},mt(wt,null,mt(io,{css:la}),mt("h2",null,e?.label?mt("span",null,"Add all ",e.label," shortcuts!"):mt("span",null,a," crafted a productivity gift for you!")),mt("div",{class:"shared-shortcuts-container"},mt("div",{id:"logged-in-shared-shortcuts-container",hidden:!f},mt("button",{id:"receive-shortcuts",class:"button-medium primary",type:"submit"},"Add all shortcuts"),mt("p",{class:"receive-information"},"Nothing will be overwritten.",mt("br",null),"You can delete or edit later.")),mt("div",{id:"guest-shared-shortcuts-container",hidden:f},mt("button",{class:"button-medium primary sign-up-button","data-open-in-same-tab":!0,type:"submit"},"Get started"),mt("p",{class:"receive-information"},"Join now or sign in to ",mt("br",null),"unlock your new shortcuts.")),mt("div",null,C?mt("div",{class:"preview-container"},mt("div",{class:"preview-emoji"},e?.metadata?.emoji),e.highlightedSnippets?.map((e=>mt("div",{class:"preview-snippet",key:e.id},mt("p",{class:"preview-trigger-text preview-snippet-text"},e.trigger),mt("div",{class:"preview-snippet-arrow"},mt(Co,null)),mt("div",{class:"preview-snippet-text preview-truncate"},mt(XL,{id:e.trigger,content:e.body,isPreview:!0})))))):mt("svg",{width:"177",height:"114",viewBox:"0 0 177 114",fill:"none",xmlns:"http://www.w3.org/2000/svg"},mt("path",{d:"M16 4C16 1.79086 17.7909 0 20 0H157C159.209 0 161 1.79086 161 4H16Z",fill:"#FDEAD9"}),mt("path",{d:"M8 9C8 6.79086 9.79086 5 12 5H165C167.209 5 169 6.79086 169 9H8Z",fill:"#FDEAD9"}),mt("rect",{x:"0.5",y:"10.5",width:"176",height:"103",rx:"7.5",fill:"#FDEAD9"}),mt("text",{x:"50",y:"70","text-anchor":"middle",class:"shared-shortcuts-number"},n),mt("text",{x:"50",y:"100","text-anchor":"middle",class:"shared-shortcuts-label"},r$1),mt("path",{d:"M165.8 53.6C165.8 51.6118 167.412 50 169.4 50C171.388 50 173 51.6118 173 53.6V82.4C173 84.3882 171.388 86 169.4 86C167.412 86 165.8 84.3882 165.8 82.4V53.6Z",fill:"#ACC1FF"}),mt("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M171.8 82.4V53.6C171.8 52.2745 170.726 51.2 169.4 51.2C168.075 51.2 167 52.2745 167 53.6V82.4C167 83.7255 168.075 84.8 169.4 84.8C170.726 84.8 171.8 83.7255 171.8 82.4ZM169.4 50C167.412 50 165.8 51.6118 165.8 53.6V82.4C165.8 84.3882 167.412 86 169.4 86C171.388 86 173 84.3882 173 82.4V53.6C173 51.6118 171.388 50 169.4 50Z",fill:"#829AFF"}),mt("circle",{cx:"125",cy:"61.9999",r:"33.6",fill:"#EEF4FF"}),mt("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"103",y:"36",width:"69",height:"47"},mt("rect",{width:"68.4",height:"46.8",transform:"matrix(-1 0 0 1 171.8 36.2)",fill:"#C4C4C4"})),mt("g",{mask:"url(#mask0)"},mt("path",{d:"M120.694 42.7169C119.492 40.3794 120.293 38.785 122.477 38.2211C124.186 37.7798 126.635 38.0388 128.233 38.7671C129.596 39.3895 130.682 40.3834 132.169 42.1497C132.342 42.3561 132.98 43.1251 133.125 43.298C133.514 43.7614 134.755 45.2746 134.919 45.4727C135.109 45.7011 135.286 45.9106 135.454 46.1077C135.373 45.0785 135.343 44.2564 135.375 43.4256C135.483 40.6726 136.295 38.831 138.164 38.2525C139.15 37.9556 140.196 38.4693 140.562 39.4289C140.932 40.4614 141.234 41.5085 141.47 42.5713C141.775 43.7842 142.142 44.8631 142.873 46.8006C142.909 46.8965 142.919 46.921 143.009 47.1604C143.393 48.1769 143.575 48.6679 143.782 49.2602C143.793 49.2919 143.793 49.2919 143.804 49.3236C143.909 49.6257 144.275 50.7426 144.34 50.9344C144.713 52.0365 145.017 52.7703 145.369 53.3432C145.977 54.3336 148.494 54.9898 156.032 56.2066C157.477 56.4402 160.015 56.6316 163.326 56.7833C165.226 56.8703 176.885 56.9388 178.921 56.991C179.634 57.0092 180.296 57.0241 180.89 57.0359C181.098 57.04 181.282 57.0434 181.441 57.0462C181.536 57.0479 181.602 57.049 181.636 57.0495C181.838 57.0526 182 57.2174 182 57.4196V79.5346C182 79.7391 181.834 79.9048 181.63 79.9048C180.793 79.9048 179.862 79.9234 178.6 79.9625C177.928 79.9833 165.672 80.0743 165.199 80.0898C161.602 80.2079 158.543 80.2694 154.889 80.2749C153.526 80.2749 152.412 80.2845 149.41 80.3175C148.77 80.3245 148.387 80.3287 147.978 80.3329C144.841 80.365 142.796 80.3706 141.002 80.3415C136.549 80.2747 132.11 79.8312 127.731 79.0158C125.161 78.5488 114.732 75.0112 112.154 73.6611C111.062 73.0907 109.923 72.2421 109.207 71.3675C108.213 70.1541 108.041 68.9217 108.987 67.8656C109.477 67.3193 110.133 67.0777 110.988 67.0605C111.593 67.0482 111.992 67.1018 113.409 67.3434C114.669 67.558 115.373 67.6377 116.154 67.613C118.747 67.5312 121.16 65.1934 122.158 62.1314C123.312 58.5204 120.841 53.9997 117.239 53.1911C115.998 52.9094 114.747 53.2362 112.467 54.1964C112.258 54.2845 112.141 54.3442 111.646 54.607C111.009 54.9456 110.657 55.1036 110.243 55.201C109.745 55.318 109.284 55.2888 108.85 55.0812C107.322 54.3495 107.249 52.0943 108.337 50.6848C109.481 49.2039 111.117 47.901 112.704 47.264C115.583 46.1115 118.372 46.1533 121.491 47.2778C121.999 47.4627 122.5 47.664 122.994 47.8815C121.989 45.4124 121.45 44.1893 120.694 42.7169Z",fill:"#F1C59D"}),mt("path",{d:"M128.323 50.9517C126.986 49.8433 125.066 48.7394 123.121 47.9229C122.933 47.8438 122.844 47.6268 122.923 47.4384C123.003 47.2499 123.219 47.1612 123.408 47.2404C125.415 48.0832 127.397 49.2227 128.795 50.3817C128.953 50.5121 128.975 50.7454 128.844 50.9028C128.714 51.0602 128.481 51.0821 128.323 50.9517Z",fill:"#CD9148"}),mt("path",{d:"M138.151 48.9961C137.187 48.2137 136.288 47.3528 135.466 46.4221C135.331 46.2689 135.345 46.035 135.498 45.8997C135.651 45.7643 135.885 45.7787 136.021 45.9319C136.816 46.832 137.685 47.6646 138.617 48.4212C138.776 48.55 138.8 48.7831 138.672 48.9418C138.543 49.1006 138.31 49.1249 138.151 48.9961Z",fill:"#CD9148"}),mt("path",{d:"M123.844 38.0489C124.436 38.2323 125.23 39.06 125.975 40.0424C126.228 40.3766 126.488 40.727 126.815 41.1721C126.958 41.3664 127.457 42.0472 127.459 42.0504C128.412 43.3498 128.991 44.1114 129.629 44.8825C129.939 45.2567 130.188 45.5706 130.712 46.2412L130.751 46.2923C131.428 47.1577 131.752 47.5627 132.158 48.0341C132.282 48.178 132.402 48.3244 132.574 48.5385C132.609 48.5811 132.728 48.7293 132.729 48.7307C133.174 49.2844 133.419 49.5668 133.709 49.8397C133.858 49.9796 133.866 50.2138 133.726 50.3629C133.586 50.5119 133.352 50.5193 133.203 50.3794C132.879 50.0756 132.618 49.7742 132.152 49.1945C132.15 49.1927 132.032 49.0449 131.998 49.0027C131.83 48.7942 131.714 48.6531 131.597 48.5167C131.181 48.0339 130.851 47.6226 130.168 46.7481L130.128 46.697C129.608 46.0317 129.362 45.7215 129.059 45.3543C128.409 44.5692 127.823 43.7985 126.862 42.4882C126.86 42.4846 126.361 41.8042 126.219 41.6105C125.894 41.1681 125.635 40.8203 125.385 40.4895C124.751 39.654 124.002 38.8728 123.625 38.756C123.43 38.6956 123.321 38.4883 123.381 38.293C123.442 38.0977 123.649 37.9884 123.844 38.0489Z",fill:"#CD9148"}),mt("path",{d:"M139.898 41.852C139.763 41.8517 139.628 41.8412 139.495 41.8206C138.845 41.7188 138.719 41.2339 138.645 40.7453C138.549 40.105 138.632 39.6072 138.904 39.1797C139.085 38.7797 139.513 38.5518 139.946 38.6245C140.217 38.835 140.425 39.1152 140.548 39.4351C140.783 40.0606 140.981 40.6996 141.14 41.3486C140.823 41.7632 140.294 41.852 139.898 41.852Z",fill:"#A02E28"}),mt("path",{d:"M107.617 52.5377C107.68 51.867 107.927 51.2267 108.33 50.6871C108.927 49.9187 109.617 49.2274 110.384 48.6292C111.013 48.8364 111.957 49.4878 111.852 50.2485C111.782 50.5431 111.644 50.8171 111.448 51.0479L111.378 51.1479C111.063 51.5957 110.68 52.1009 110.099 52.4155C109.639 52.6642 109.127 52.7999 108.604 52.8116C108.395 52.8134 108.187 52.7828 107.988 52.7209C107.856 52.6791 107.731 52.6173 107.617 52.5377Z",fill:"#A02E28"}),mt("path",{d:"M108.911 69.0822C109.017 68.8857 109.19 68.7339 109.398 68.6547C109.827 68.4697 110.442 68.5566 110.712 68.6122C111.357 68.7475 111.967 69.014 112.505 69.395C112.738 69.5671 113.121 69.7651 113.09 70.3499C113.03 70.8057 112.864 71.2411 112.605 71.6213C112.319 72.0583 111.842 72.3332 111.321 72.3615C111.298 72.3634 111.275 72.3634 111.252 72.3615C110.745 72.2818 110.274 72.0479 109.903 71.6916C108.946 70.8015 108.487 69.9317 108.911 69.0822Z",fill:"#A02E28"}),mt("path",{d:"M124.684 39.6516C125.139 40.3327 125.073 40.9063 124.486 41.3524C124.116 41.6373 123.7 41.7743 123.035 41.7373C122.804 41.7316 122.578 41.6617 122.384 41.5356C121.875 41.1858 121.468 40.6102 121.386 40.1198C121.301 39.5905 121.36 38.6689 122.156 38.4339C123.08 38.1637 123.735 38.4024 124.684 39.6516Z",fill:"#A02E28"}),mt("path",{d:"M126.388 39.4851C126.246 39.1353 126.244 38.4043 127.06 38.3599C127.549 38.3321 128.147 38.569 128.456 38.73C128.91 38.9494 129.333 39.2275 129.714 39.5573C129.9 39.708 130.022 39.9235 130.056 40.1606C130.056 40.6491 129.44 40.8027 128.959 40.8805C128.421 40.9527 127.874 40.8645 127.386 40.6269C126.959 40.34 126.615 39.9463 126.388 39.4851Z",fill:"#A02E28"})),mt("mask",{id:"mask1","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"87",y:"51",width:"26",height:"19"},mt("path",{d:"M89 51.8H107.6L107.9 53.3L108.8 54.8L110.3 55.1L111.5 54.8L112.4 54.2L112.7 68L111.5 69.2001L87.2 69.8L87.5 53.3L89 51.8Z",fill:"black"})),mt("g",{mask:"url(#mask1)"},mt("path",{d:"M112.05 53.2335C112.035 52.9911 111.843 52.7967 111.601 52.7778C111.569 52.7752 111.507 52.7705 111.419 52.7638C111.273 52.7528 111.108 52.7404 110.927 52.7272C110.41 52.6892 109.867 52.6513 109.326 52.6159C109.012 52.5954 108.707 52.5763 108.414 52.5589C107.403 52.4989 106.582 52.462 106.018 52.4547C105.868 52.4527 105.74 52.4509 105.485 52.4473C104.373 52.4316 103.898 52.426 103.289 52.4232C101.859 52.4167 100.677 52.4386 99.5234 52.5017C98.281 52.5692 97.2872 52.5702 95.0635 52.5324C93.786 52.5106 93.2214 52.5043 92.5112 52.5088C91.1352 52.5175 89.9691 52.5773 88.8454 52.7115C88.6283 52.7374 88.455 52.9049 88.4216 53.121C88.2443 54.2695 88.1292 55.5097 88.0249 57.1936C87.9987 57.6178 87.9849 57.8584 87.9352 58.7501C87.8714 59.8923 87.8357 60.4733 87.7864 61.115C87.7284 61.8684 87.689 62.8524 87.6653 64.0135C87.6384 65.3401 87.6337 66.7449 87.6423 68.0121C87.6432 68.1327 87.644 68.24 87.6449 68.3328C87.6454 68.3887 87.6459 68.4272 87.6461 68.4475C87.6491 68.707 87.855 68.9185 88.1142 68.9287C88.1525 68.9302 88.2249 68.933 88.3277 68.9369C88.4988 68.9434 88.6926 68.9507 88.9051 68.9585C89.5121 68.981 90.1474 69.0034 90.7801 69.0243C91.1288 69.0358 91.4675 69.0466 91.7934 69.0564C92.9715 69.0921 93.9238 69.1142 94.5715 69.1191C95.5383 69.1258 96.5489 69.1115 97.723 69.0779C98.4251 69.0578 98.9881 69.038 100.247 68.9909C102.12 68.9209 102.948 68.8939 103.983 68.8754C104.735 68.8616 105.718 68.8068 106.879 68.719C107.361 68.6825 107.866 68.6408 108.387 68.5951C109.091 68.5332 109.787 68.467 110.447 68.4007C110.677 68.3775 110.887 68.356 111.071 68.3367C111.182 68.325 111.26 68.3167 111.301 68.3123C111.512 68.2895 111.684 68.1334 111.726 67.926C112.035 66.4261 112.197 64.2797 112.24 61.6451C112.273 59.6221 112.235 57.4564 112.151 55.3295C112.129 54.7717 112.105 54.2596 112.081 53.8045C112.073 53.6451 112.065 53.5041 112.058 53.3829C112.054 53.31 112.051 53.2597 112.05 53.2335Z",fill:"#91D5DD"})),mt("path",{d:"M97.2773 52.6558C96.6667 52.2479 95.0594 51.2124 94.5411 50.854C92.1829 49.2234 90.8479 47.8256 90.6611 46.309C90.4143 44.3155 91.4148 43.5712 92.9377 44.2391C93.976 44.6944 95.2855 45.8175 96.0339 46.8295C96.9785 48.1067 97.5646 49.1588 97.9023 50.385C97.9629 50.2115 98.0211 50.0508 98.0777 49.9012C98.2275 49.5054 98.3628 49.1953 98.4896 48.9703C99.2369 47.6458 100.406 46.1232 101.272 45.5126C101.936 45.044 102.736 44.6499 103.438 44.5264C104.526 44.3352 105.348 44.8076 105.565 45.9911C105.702 46.7383 105.359 47.478 104.678 48.2272C104.231 48.7191 103.746 49.1203 103.008 49.6629C101.885 50.4715 100.728 51.2292 99.5415 51.9347C101.346 52.3886 102.673 54.0813 103.09 56.0907C103.144 56.3542 102.975 56.6121 102.711 56.6667C102.448 56.7213 102.19 56.552 102.135 56.2885C101.71 54.2376 100.182 52.6339 98.2624 52.8058C98.2674 52.8987 98.2717 52.993 98.2754 53.0888C98.2765 53.1167 98.2752 53.1446 98.2715 53.1723C97.9251 55.7618 97.7466 58.371 97.7374 60.9835C97.7562 64.4842 97.8356 66.4341 98.1066 68.6882C98.1388 68.9553 97.9482 69.198 97.681 69.2301C97.4139 69.2623 97.1712 69.0717 97.1391 68.8045C96.8625 66.5046 96.7819 64.5238 96.7629 60.9844C96.7722 58.3396 96.9516 55.7024 97.3 53.0849C97.294 52.9379 97.2865 52.795 97.2773 52.6558ZM95.2504 47.4089C94.5971 46.5256 93.4167 45.5133 92.5463 45.1316C91.7152 44.7671 91.4743 44.9462 91.6283 46.1896C91.7684 47.3271 92.9634 48.5783 95.0953 50.0524C95.457 50.3025 96.399 50.9141 97.1305 51.3925C96.8726 49.9372 96.3147 48.8481 95.2504 47.4089ZM102.435 48.8749C103.94 47.767 104.739 46.8883 104.606 46.1671C104.493 45.5502 104.2 45.3819 103.607 45.4862C103.072 45.5804 102.391 45.9158 101.833 46.309C101.113 46.8169 100.02 48.2401 99.3385 49.449C99.2412 49.6217 99.123 49.8925 98.9892 50.2461C98.9093 50.4571 98.8251 50.6945 98.7343 50.962C98.7027 51.0552 98.6563 51.1956 98.6041 51.355C99.9207 50.5917 101.199 49.7641 102.435 48.8749Z",fill:"#FC6E47"}),mt("path",{d:"M97.5756 52.6841C96.6606 52.5576 95.3189 52.6682 94.7878 52.9562C93.3887 53.7652 92.2585 54.9892 91.5578 56.4602C91.442 56.7031 91.1513 56.8062 90.9083 56.6905C90.6654 56.5748 90.5622 56.284 90.678 56.0411C91.4634 54.3921 92.7304 53.0201 94.3117 52.1061C95.0731 51.6929 96.6073 51.5664 97.7091 51.7188C97.9757 51.7557 98.1619 52.0017 98.125 52.2682C98.0881 52.5348 97.8421 52.721 97.5756 52.6841Z",fill:"#FC6E47"}),mt("path",{d:"M112.018 60.2228C111.036 60.151 110.308 60.0939 108.448 59.9447C104.655 59.6406 102.881 59.5144 100.73 59.4178C99.1296 59.3459 97.6451 59.3139 96.221 59.3251C92.3698 59.357 90.5038 59.4369 88.0466 59.7381C87.7795 59.7708 87.5365 59.5808 87.5037 59.3137C87.471 59.0466 87.661 58.8035 87.9281 58.7708C90.4311 58.464 92.3274 58.3828 96.2132 58.3506C97.6557 58.3393 99.1571 58.3716 100.774 58.4443C102.94 58.5416 104.721 58.6683 108.526 58.9733C110.383 59.1223 111.11 59.1793 112.089 59.2509C112.357 59.2705 112.559 59.504 112.539 59.7724C112.52 60.0407 112.286 60.2424 112.018 60.2228Z",fill:"#FC6E47"}),mt("rect",{x:"0.5",y:"10.5",width:"176",height:"103",rx:"7.5",stroke:"#FFE0B5"}))))))}const ga=new he("template-source"),ma=oo`
  dialog {
    max-width: 450px;
  }
  .accept-shortcuts-container {
    display: flex;
    align-items: center;
  }
  img {
    max-width: 180px;
    margin-left: 20px;
  }
  button {
    height: 100%;
    flex-grow: 1;
  }
`;function fa(){const e=to((e=>e.global.config.harpaulSharedShortcutCollection)),t=to((e=>e.global.config.harpaulSharedVariableShortcutCollection)),s=to((e=>e.global.config.magicalMarketingURL)),n=to((e=>e.global.userInfo.featureFlags.variablesEnabled))||!1,o=a.browser.runtime.getURL("assets/harpaul-shared-shortcuts.png"),r=n?t:e;return mt(Jt,{title:"Magical Founder, Harpaul, shared his favorite shortcuts with you!",showModal:!0,allowClose:!1},mt(wt,null,mt(io,{css:ma}),mt("div",{class:"accept-shortcuts-container"},mt("button",{class:"button-medium primary",onClick:async function(){ni({type:"checklist.accept-shortcuts"});const e=await ga.request("getSnippetCollection",r);await pa(r,e,s);}},"Add shortcuts"),mt("img",{src:o}))))}const ba=new he("delete-shortcut-dialog"),ya=oo`
  dialog {
    width: 30%;
    min-width: 480px;
  }
`;function va(){Ro.dispatch(ut());}function Ca(){const{deleteShortcutsDialog:{showModal:e,shortcutIds:t}}=to((e=>e.dialogs)),{saved:a}=to((e=>e.optionsPage));let s="";1===t.length&&(s=a.find((e=>t.includes(e.id)))?.trigger||"");const n=t.length>1?`Delete ${t.length} shortcuts?`:`Delete shortcut ${s}?`;return mt(Jt,{title:n,showModal:e,onCloseCallback:va,onSubmitCallback:va},mt(wt,null,mt(io,{css:ya}),mt("p",null,"We'll delete from any shared shortcut links, too. People who already added from a share link will not be affected."),mt("menu",null,mt("button",{className:"button-medium primary",type:"submit",onClick:()=>async function(e){try{ni({type:"ate_removeSnippet",count:e.length,snippetIds:e}),await ba.request("delete",e),xn().textContent=`Deleted ${e.length} shortcut${e.length>1?"s":""}`;}catch(e){En().textContent="Error deleting. Please try again.";}}(t)},"Yes, delete")," ",mt("button",{className:"button-medium secondary",type:"reset",onClick:va,autoFocus:!0},"No, cancel"))))}const wa=oo`
dialog {
  max-width: 460px;
}
.feature-gate-graphic {
    width: 160px;
}
.feature-gate-content {
  display: flex;
}

`;function Sa(){Ro.dispatch(Ze());}function xa(){const{featureGateCreateDialogOpen:e}=to((e=>e.dialogs));return mt(Jt,{title:"Join now for free to create more shortcuts!",showModal:e,onCloseCallback:Sa},mt(wt,null,mt(io,{css:wa}),mt("div",{class:"feature-gate-content"},mt("div",{class:"feature-gate-graphic"},mt(to$1,null)),mt("div",null,mt("p",null,"Continue to save time with Magical! Register with email to create more shortcuts. 💚"),mt("button",{target:"_blank",rel:"noreferrer",class:"button-medium primary",onClick:e=>{ni({type:"feature-gate.create.join"}),Ro.dispatch(Ao(!0)),Sa();}},"Join now in seconds (it's free!)")))))}const ka=new he("settings");function Ea(){ni({type:"pro-beta-upgrade.modal.explore"}),ka.notification("updateUserOnboarding",{proBetaUpgradeModalClosed:!0});}const Ia=oo`
  dialog {
    padding: 24px;
    max-width: 460px;
  }
  h2 {
    display: flex;
    align-items: flex-end;
    margin-bottom: 10px;
    font-size: 32px;
  }
  svg {
    margin-bottom: 2px;
  }
  h3 {
    font-size: 16px;
    margin-top: 0px;
  }
  a {
    display: block;
  }
  iframe {
    min-width: 400px;
    border: 1px solid var(--magical-gray-30);
    border-radius: 12px;
    min-height: 225px;
  }
  p {
    color: black;
    font-weight: 400;
  }
`;function Ta(){on$1((()=>ni({type:"pro-beta-upgrade.modal.show"})),[]);const e=to((e=>e.global.userInfo.onboarding?.proBetaCohort)),t=to((e=>e.global.config.proBetaUpgradeFrameUrl)),a=to((e=>e.global.config.extensionProBetaOnboardingFrameURL)),s=e===R.REFERRAL_CREDITS?"Because someone you referred joined Magical...":"Because you’re our favorite magician...";return mt(Jt,{title:void 0,showModal:!0,onCloseCallback:void 0,allowClose:!1},mt(wt,null,mt(io,{css:Ia}),mt("h3",null,s),mt("h2",null,"You now have ",mt(ro,null)),mt("p",null,"Magical Pro effortlessly moves data across all of your websites so you can automatically fill your shortcuts.",mt("br",null),"No more copy and paste. "),mt("iframe",{id:"promo-iframe",class:"options-card",src:t,scrolling:"no"}),mt("a",{href:a,target:"_blank",rel:"noreferrer",class:"button-medium primary",onClick:Ea},"Explore")))}const Ra=new he("settings");function Pa(){ni({type:"settings.modal.close"}),Ro.dispatch(Ye()),Sn(["dialog"]);}function Oa(){ni({type:"settings.modal.cancel"}),Pa();}function Ma(){ni({type:"settings.modal.join"}),Ro.dispatch(Ao(!0));}const Fa=oo`
  dialog {
    padding: 24px;
    max-width: 460px;
  }

  h3 {
    margin-block-end: 0.25em;
  }
  
  p {
    margin-top: 0;
    margin-bottom: 0.5em;
  }

  .settings-item-content {
    margin-bottom: 1em;
    flex-direction: row;
    display: flex;
  }

  .settings-item-text {
    flex-direction: column;
    display: flex;
    padding-right: 1em;
  }

  .settings-item-form {
    flex-direction: column;
    display: flex;
    align-items: end;
  }

  .settings-item-header-div {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .settings-item-labeled-input-div {
    margin-block-start: 1em;
    border-style: solid;
    text-align: left;
    border-radius: 8px;
    border-color: var(--magical-gray-20);
    font: inherit;
    font-size: 0.9em;
    font-weight: bold;
    max-width: fit-content;
    border-width: thin;
    background-color: var(--magical-gray-00);
  }

  .settings-item-labeled-input-p {
    margin-bottom: auto;
    padding-left: 12px;
    padding-top: 8px;
  }

  .settings-text-input {
    max-width: 70px;
    max-height: 38px;
    border: none;
    background-color: inherit;
  }

  .slider.round {
    border-radius: 34px;
  }
  
  .slider.round:before {
    border-radius: 50%;
  }

  .switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
    margin-block-start: 1em;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--magical-gray-40);
    -webkit-transition: .4s;
    transition: .4s;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
  }

  input:checked + .slider {
    background-color: var(--magical-green-60);
  }

  input:checked[disabled] + .slider {
    background-color: var(--magical-gray-20);
    cursor: auto;
  }

  input:focus + .slider {
    box-shadow: 0 0 1px #2196F3;
  }

  input:checked + .slider:before {
    -webkit-transform: translateX(26px);
    -ms-transform: translateX(26px);
    transform: translateX(26px);
  }

  .join-now-cta {
    cursor:pointer;
    color:blue;
    text-decoration:underline;
  }
`;function Aa(){const e=to((e=>e.global.userInfo.email)),{triggerInput:t,autosuggestShortcutEnabled:a}=no(Ge),[s,n]=nn$2(a),[o,r]=nn$2(a),[i,l]=nn$2(t),c=to((e=>e.global.userInfo.featureFlags.autosuggestShortcutCreationEnabled)),d=to((e=>e.global.userInfo.featureFlags.autosuggestVariableCreationEnabled)),u=mt("p",null,mt("b",null,mt("a",{class:"join-now-cta",onClick:Ma},"Join now or sign in")," to change settings ✨")),p=mt("div",{class:"settings-item-content"},mt("div",{class:"settings-item-text"},mt("h3",null,"Autosuggest Shortcuts"),mt("p",null,"Magical suggests shortcuts for text you frequently paste.")),mt("div",{class:"settings-item-form"},mt("label",{class:"switch"},mt("input",{type:"checkbox",disabled:!e,checked:s,onChange:()=>{e&&n(!s);}}),mt("span",{class:"slider round"})))),h=mt("div",{class:"settings-item-content"},mt("div",{class:"settings-item-text"},mt("h3",null,"Autosuggest Variables"),mt("p",null,"Magical suggests variables for page elements you frequently paste.")),mt("div",{class:"settings-item-form"},mt("label",{class:"switch"},mt("input",{type:"checkbox",disabled:!e,checked:o,onChange:()=>{e&&r(!o);}}),mt("span",{class:"slider round"})))),g=mt("div",{class:"settings-item-content"},mt("div",{class:"settings-item-text"},mt("h3",null,"Custom Dropdown Prompt"),mt("p",null,"Change your prompt from ",i," to any two characters.")),mt("div",{class:"settings-item-forms"},mt("div",{class:"settings-item-labeled-input-div",disabled:!e},mt("p",{class:"settings-item-labeled-input-p",disabled:!e},"Keys"),mt("input",{disabled:!e,class:"settings-text-input",minLength:2,maxLength:2,required:!0,value:i,onKeyUp:e=>{const t=e.target;t.value&&l(t.value);}}))));return mt(Jt,{title:"Settings",showModal:!0,onCloseCallback:Pa,onSubmitCallback:()=>{e&&(Ra.notification("updateUserSettings",{autosuggestShortcutEnabled:s,triggerInput:i,autosuggestVariableEnabled:o}),ni({type:"settings.modal.save",autosuggestShortcutEnabled:s,triggerInput:i,autosuggestVariableEnabled:o}),xn().textContent="Settings saved");}},mt(wt,null,mt(io,{css:Fa}),c&&p,d&&h,g,!e&&u,mt("button",{type:"submit",class:"button-medium primary",disabled:!e},"Save Settings"),mt("button",{type:"button",class:"button-medium tertiary",onClick:Oa,disabled:!e},"Cancel")))}const Na=new he("shareFirstShortcut"),Da=oo`
  dialog {
    min-width: 500px;
  }
`,ja=oo`
  dialog {
    max-width: 800px;
    background-color: var(--magical-gray-00);
  }
`;function Ba(){const e=to((e=>e.global.notifications.shareFirstShortcut)),t=to((e=>e.global.config.shareShortcutsUrl)),a=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled)),s=to((e=>e.global.userInfo.featureFlags.referralCreditsExperimentSequenceEnabled)),n=to((e=>e.global.userInfo.featureFlags.referralCreditsProBetaDefaultSequenceEnabled)),o=to((e=>e.global.referrals)),r=e?.shortcutId||"",[i,l]=nn$2({url:"",collectionId:""});on$1((()=>{!async function(){if(r){const e=await sa([r]),o=te$1(new URL(`${t}?shareId=${e.id}`),{referralCreditsEnabled:a,referralCreditsProBetaDefaultSequenceEnabled:n,referralCreditsExperimentSequenceEnabled:s}).toString();l({url:o,collectionId:e.id});}}();}),[r,t,a,n,s]);return mt(Jt,{title:void 0,showModal:!!r,onCloseCallback:()=>{ni({type:"ate_shareShortcuts_onFirstSave.close"}),g({shareFirstShortcut:{closed:!0}});}},mt(wt,null,mt(io,{css:a?ja:Da}),mt(Xt,{header:"🎉 Nice shortcut! Wanna share it?",shareUrl:i.url,copyUrlTracking:{type:"ate_shareShortcuts_onFirstSave.copy",shortcutId:r},onSendEmailClick:async e=>{const t=await Na.request("shareShortcutsByEmail",{emails:e,collectionId:i.collectionId,utmCampaign:ee({referralCreditsEnabled:a,referralCreditsProBetaDefaultSequenceEnabled:n,referralCreditsExperimentSequenceEnabled:s})});return t&&ni({type:"workspace.share.email",entryPoint:"saveFirstShortcut",referralCount:o.length,emailCount:e.length,shortcutCount:1,collectionId:i.collectionId}),t}})))}const _a=new he("timeSavedDialog"),La=new he("timeSavedDialog"),qa=oo`
  dialog {
    min-width: 500px;
  }
  h2 {
    margin: 0;
    padding-bottom: 8px;
  }
  p {
    margin-top: 0;
  }
  .rateapp-content {
    display: flex;
  }
  .rateapp-container {
    background-color: white;
    margin: -15px;
    padding: 20px;
    max-width: 450px;
  }
  img {
    max-width: 120px;
    max-height: 120px;
  }
  .close-dialog-button {
    margin-top: 10px;
  }
`,Ua=oo`
  dialog {
    background-color: var(--magical-gray-10);
    min-width: 800px;
  }
`;function Va(){const e=to((e=>e.global.config.savedTimeMessages)),t=to((e=>e.global.notifications)),s=to((e=>e.global.totalTimeSaved)),n=to((e=>e.global.userInfo.referralCode)),o=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled)),r=to((e=>e.global.userInfo.featureFlags.referralCreditsProBetaDefaultSequenceEnabled)),i=to((e=>e.global.userInfo.featureFlags.referralCreditsExperimentSequenceEnabled)),l=to((e=>e.global.referrals)),c=to((e=>e.global.userInfo.email)),p=ne({referralCreditsEnabled:o,referralCreditsProBetaDefaultSequenceEnabled:r,referralCreditsExperimentSequenceEnabled:i}).toString(),h=a.browser.runtime.getURL("assets/five-stars.gif"),g$1=un$1(s),m=e.findIndex((e=>e.secondsSaved<g$1)),f=e[m]?.secondsSaved??0;let b="share";on$1((()=>{ni({type:"workspace.share.show",entryPoint:"timeSaved",referralCount:l.length,timeSavedThreshold:f,timeSavedCta:b});}),[l.length,f,b]);const y=async()=>{v(),ni({type:"timeSaved.modal.close",cta:b,timeSavedThreshold:f}),c&&La.notification("sendRateAppReminder");},v=()=>{if(m>0){const t=e[m-1];g({nextTimeSavedThreshold:t.secondsSaved});}},C=async e=>{const t=await _a.request("shareAppByEmail",{emails:e,referralCode:n,utmCampaign:ee({referralCreditsEnabled:o,referralCreditsProBetaDefaultSequenceEnabled:r,referralCreditsExperimentSequenceEnabled:i})});return t&&ni({type:"workspace.share.email",entryPoint:"timeSaved",referralCount:l.length,timeSavedThreshold:f,timeSavedCta:b,emailCount:e.length}),t};let w=null,S=qa;const x=`Magical has saved you ${s.timeSaved}+ ${s.unit}. ${s.message} ${s.emoji}`;return t.nextTimeSavedThreshold&&t.nextTimeSavedThreshold>0?(o&&(S=`\n        ${qa}\n        ${Ua}\n      `),w=mt(Xt,{header:x,shareUrl:p,copyUrlTracking:{type:"workspace.share.copy",entryPoint:"timeSaved",referralCount:l.length,timeSavedCta:b,timeSavedThreshold:f},onSendEmailClick:C})):(w=mt("div",{class:"rateapp-container"},mt("h2",null,x),mt("div",{class:"rateapp-content"},mt("div",null,mt("p",null,"Help keep Magical free. Take a minute to rate 5 stars or give us feedback to improve."),mt("a",{href:"https://chrome.google.com/webstore/detail/iibninhmiggehlcdolcilmhacighjamp/reviews",target:"_blank",rel:"noreferrer",class:"button-medium primary",onClick:y},"Rate 5 stars"),"  ",mt("a",{href:`${zn}/feed/feedback-questions`,target:"_blank",rel:"noreferrer",class:"button-medium secondary",onClick:()=>{v(),ni({type:"timeSaved.modal.close",cta:b,timeSavedThreshold:f});}},"Give feedback")),mt("img",{src:h}))),b="rate"),mt(Jt,{title:void 0,showModal:!0,onCloseCallback:()=>{ni({type:"timeSaved.modal.close",cta:b,timeSavedThreshold:f}),v();}},mt(wt,null,mt(io,{css:S}),w))}const $a=oo`
  dialog {
    width: 500px;
    padding: 20px 20px 0 20px;
  }
  h3 {
    display: inline;
    color: black;
  }
  #share-button {
    margin-bottom: 20px;
  }
  .shortcut-info {
    display: flex;
  }
  .shortcut-text {
    flex-grow: 1;
  }
  .shortcut-body {
    display: -webkit-box;
    overflow: hidden;
    -webkit-line-clamp: 6;
    -webkit-box-orient: vertical;
    max-width: 350px;
  }
  .graphic {
    margin: 0 10px;
    position: absolute;
    bottom: -10px;
    right: 0;
  }
`;function Wa(){const e=to((e=>e.dialogs.topShortcutDialog)),t=to((e=>e.global.snippets)),{shortcutId:a}=e,[s,n]=nn$2(""),[o,r]=nn$2(""),[i,l]=nn$2(""),[c,d]=nn$2(null);on$1((()=>{!async function(e){if(Object.keys(t).length>0){const a=t.find((t=>t.id===e));a?(ni({type:"topShortcut.modal.show",shortcutId:e}),n(a.plainTextBody),r(a.trigger),l("🥳 Share your top shortcut!"),d(mt(qr,null))):(ni({type:"topShortcut.modal.no-permission",shortcutId:e}),l("😢 You don’t have permission to see this shortcut"),d(mt(eo,null)));}}(a);}),[a,t]);const u=()=>{Ro.dispatch(nt()),Sn(["dialog","shortcutId"]);},p=()=>{ni({type:"topShortcut.modal.share",shortcutId:a}),u(),Ro.dispatch(ot({shortcutIds:[a]}));};let h=mt(wt,null,mt("p",null,"Ask the owner to share it with you!"),mt("button",{class:"button-medium primary",onClick:()=>{ni({type:"topShortcut.modal.dismiss",shortcutId:a}),u();}},"Dismiss"));return o&&(h=mt(wt,null,mt("p",null,mt("h3",null,"Trigger:")," ",o),mt("p",{class:"shortcut-body"},mt("h3",null,"Body:")," ",s),mt("button",{id:"share-button",class:"button-medium primary",onClick:p},"Share"))),mt(Jt,{title:i,showModal:!0,onCloseCallback:()=>{ni({type:"topShortcut.modal.close",shortcutId:a}),u();}},mt(wt,null,mt(io,{css:$a}),mt("div",{class:"shortcut-info"},mt("div",{class:"shortcut-text"},h),mt("div",{class:"graphic"},c))))}const Ha=oo`
  dialog {
    width: 440px;
  }

  input {
    width: 70%;
    height: 48px;
    background: white;
    border: 1px solid var(--magical-gray-50);
  }
`;function za(e){const t=e.target,a=t.value;o$1(Ro.getState().global.snippetCollections).map((e=>e.label)).includes(a)?t.setCustomValidity("Tag name already exists"):t.setCustomValidity("");}function Ja(e){return "create"===e?"Create a new tag":"Rename the tag"}function Za(e){const{showModal:t,onCloseCallback:a}=e,{tagToModify:s}=Ro.getState().optionsPage,n=s?.label||"",o=s?"edit":"create",r=St();return mt(Jt,{title:Ja(o),showModal:t,onCloseCallback:a,onSubmitCallback:()=>{r.current&&(!async function(e){const{tagToModify:t}=Ro.getState().optionsPage;if(ni({type:"ate_saveTag",isNew:!t}),t?.label!==e){try{if(t)await De$1(t?.id,e);else {const{selectedIds:t}=Ro.getState().optionsPage;await we(e,t);}xn().textContent="Tag saved";}catch(e){En().textContent="Error saving tag";}Ro.dispatch(Io());}else xn().textContent="Tag saved";}(r.current.value),a());}},mt(wt,null,mt(io,{css:Ha}),mt("p",null,mt("input",{id:"tag-name",placeholder:"Enter tag name",required:!0,maxLength:20,pattern:"\\S(.*\\S)?",title:"Tag shouldn't have spaces at the beginning or the end",autoComplete:"off",value:n,autofocus:!0,onInput:za,ref:r})),mt("div",null,mt("button",{type:"submit",className:"button-medium primary"},function(e){const{selectedIds:t}=Ro.getState().optionsPage;return "create"===e?0===t?.length?"Create":"Create and apply":"Save"}(o))," ",mt("button",{type:"reset",className:"button-medium secondary cancel-tag",onClick:a},"Cancel"))))}const Ka=oo`
  dialog {
    width: 440px;
  }

  #delete-tag-label {
    font-weight: bold;
  }
`,Ga=new he("delete-tag-dialog");function Ya(e){const{showModal:t,onCloseCallback:a}=e,{global:{snippetCollections:s},optionsPage:{tagToModify:n}}=Ro.getState(),[o,i]=Qn$1.useState(""),[l,c]=Qn$1.useState("");return Qn$1.useEffect((()=>{t&&function(){const e=s.find((e=>e.id===n?.id)).snippetIds.length,t=`${e.toString()} ${tn$1("shortcut",e)}`;i(t);const a=n.label;c(a);}();}),[t,s,n]),mt(Jt,{title:"Remove and delete the tag?",showModal:t,onCloseCallback:a,onSubmitCallback:()=>{!async function(e){try{await Ga.request("deleteSnippetCollections",[e.id]),xn().textContent="Tag deleted";}catch(e){En().textContent="Error deleting tag";}}(n),a();}},mt(wt,null,mt(io,{css:Ka}),mt("p",null,"We'll remove the ",mt("span",{id:"delete-tag-label"},l)," tag from ",mt("span",{id:"delete-tag-num-shortcuts"},o)," and delete the tag."),mt("div",null,mt("button",{type:"submit",id:"delete-tag",class:"button-medium primary"},"Yes, delete")," ",mt("button",{type:"reset",class:"button-medium secondary cancel-tag",onClick:a},"No, Cancel"))))}function Qa(e){const{onClose:t,title:s,heading:n,children:o}=e,r=[{rel:"stylesheet",href:a.browser.runtime.getURL("options/features/help-cards/options-shortcut-help-card.css")}];return mt(Xo,{className:"options-shortcut-help-frame",title:s,stylesheets:r},mt("div",{class:"header"},mt("h1",null,n),mt("button",{class:"actionable-icon fab-close",onClick:t},mt(ao$1,null))),mt("div",{class:"children"},o))}const Xa=new he("options-shortcut-trigger-help"),es=()=>{Xa.notification("updateUserOnboarding",{optionsShortcutTriggerHelpClosed:!0}),Ro.dispatch(Mo()),ni({type:"trigger-help.options-shortcut.close"});};function ts(){return mt(Qa,{onClose:es,title:"Options Shortcut Name Help",heading:"Tip: Avoid unintended expansions 👻"},mt("p",null,mt("b",null,"Special characters or numbers make better trigger names!"),mt("br",null),'Ex: use "-br" as a trigger instead of "br" so your shortcut doesn\'t expand when you type “bread.”'))}const as=new he("options-shortcut-variable-help"),ss=()=>{as.notification("updateUserOnboarding",{optionsShortcutVariableHelpClosed:!0}),Ro.dispatch(No$1()),ni({type:"variables-help.options-shortcut.close"});};function ns(){ni({type:"variables-help.options-shortcut.learn"});}function os(){const e=to((e=>e.global.userInfo.settings.triggerInput)),t=to((e=>e.global.config.learnVariablesURL));return mt(Qa,{onClose:ss,title:"Options Shortcut Variables Help",heading:"Insert Variables into your shortcuts"},mt(wt,null,mt("p",null,"Add variables from any website or app. Simply type ",e," and select into your shortcut. Don’t see a variable you’d like? Create your own."),mt("img",{class:"right-rail-gif",src:a.browser.runtime.getURL("assets/variables.png")}),mt("a",{href:t,class:"button-small tertiary",onClick:ns,target:"_blank",rel:"noreferrer"},"Learn about variables")))}function rs(){const e=to((e=>e.global.notifications?.variableSuggestionSelection)),t=to((e=>e.global.userInfo.featureFlags.variablesEnabled))||!1;on$1((()=>ni({type:"variables-suggestion.options-shortcut.show",selection:e?.selection||""})),[e?.selection]);let a="Pro tip: Customize with variables 💡";return t&&(a="Pro tip: Automatically pull in variable information 💡"),mt(Qa,{onClose:()=>{ni({type:"variables-suggestion.options-shortcut.close"}),g({variableSuggestionSelection:{previouslyShownShortcutIds:e?.previouslyShownShortcutIds||[],selection:"",workspaceShortcutId:null}});},title:"Options Shortcut Variable Suggestion",heading:a},mt(cf,{variablesEnabled:t,selection:e?.selection||"a placeholder"}))}const is=["/shared-ui-components/buttons.css","/shared-ui-components/tag-dropdown.css"],ls=oo`
.dropdown-menu {
  padding: 0;
}
.dropdown-item {
  flex-direction: row;
  justify-content: flex-start;
  align-items: flex-start;
  margin-bottom: 0;
  padding: 15px 25px 10px 10px;
  width: initial;
}
.team-sharing-dropdown .team-sharing-toggle.dropdown-toggle > svg {
  width: initial;
  height: initial;
}
.dropdown-item .team-sharing-item-details {
  display: flex;
  flex-direction: column;
}
.dropdown-item .team-sharing-icon {
  width: 30px;
  display: flex;
  justify-content: center;
}
.dropdown-item .team-sharing-icon > svg {
  fill: currentColor;
}
.dropdown-item .team-sharing-item-details .team-sharing-label {
  font-size: 14px;
}
.dropdown-item .team-sharing-item-details .team-sharing-description {
  font-size: 12px;
  color: var(--magical-gray-50);
}
`,cs=null,ds="Personal";function us(e){const{onSelectCallback:t,selectedOptions:a}=e,s=to((e=>f(e.global.snippetCollections)));return mt(jp,{stylesheets:is},mt(io,{css:ls}),mt(ue,{className:"team-sharing-dropdown",onSelect:e=>{t&&t(e?[e]:null);},onClick:e=>e.stopPropagation()},mt(ue.Toggle,{className:"team-sharing-toggle tertiary-muted button-small"},a&&a.length?mt(zo,null):mt(Ko,null),mt("span",{className:"team-sharing-toggle-selected"},a&&a.length?"Team":ds)),mt(ue.Menu,null,mt(ue.Item,{eventKey:cs},mt("div",{className:"team-sharing-icon"},mt(Ko,null)),mt("div",{className:"team-sharing-item-details"},mt("div",{className:"team-sharing-label"},ds),mt("div",{className:"team-sharing-description"},"Only you"))),s.map((e=>mt(ue.Item,{key:e.id,eventKey:e.id},mt("div",{className:"team-sharing-icon"},mt(zo,null)),mt("div",{className:"team-sharing-item-details"},mt("div",{className:"team-sharing-label"},"Team"),mt("div",{className:"team-sharing-description"},mt("div",null,"Shared with your entire team"),mt("div",null,"and anyone can make a copy")))))))))}class ps extends Ot{constructor(e){super(e),this.bodyValueRef=St(),this.richTextEditorRef=St(),this.triggerFieldRef=St(),this.setRichTextEditorRef=e=>{this.richTextEditorRef.current=e;},this.setBodyValueRef=e=>{this.bodyValueRef.current=e;},this.toggleRowCheckbox=()=>{const{checked:e,snippet:t}=this.props;e?Ro.dispatch(go([t.id])):Ro.dispatch(yo([t.id]));},this.reset();}componentDidMount(){if(this.props.snippet.trigger&&"edit"!==this.props.mode||this.triggerFieldRef.current?.focus(),this.triggerFieldRef.current){const{errorMessage:e}=dr(this.triggerFieldRef.current.value,this.props.otherSavedTriggers);this.triggerFieldRef.current.setCustomValidity(e);}}componentDidUpdate(e){this.props.snippet.body!==e.snippet.body&&this.richTextEditorRef.current&&!this.richTextEditorRef.current.isDirty()&&HC(this.richTextEditorRef.current,this.props.snippet.body,!1);}render(){const{checked:e,collections:t,variablesEnabled:a,hasVariablesAvailable:s,hidden:n,isUnsaved:o,isInConflict:r,mode:i,notifications:l,otherSavedTriggers:c,placeholdersEnabled:d,showTriggerHelp:u,showVariableHelp:p,showVariableSuggestion:h,snippet:g,srcPagesForClosedTabs:m,srcPagesWithVariables:f$1,richTextEditorEnabled:b,variableSuggestionPatterns:y,teamsEnabled:v,draftTeamShareSelections:C}=this.props,w=!!b&&this.state.isRichTextEditorCompatible,S=pr(this.state.trigger,g.trigger),x=fr(this.bodyValueRef,this.richTextEditorRef,g,w).richTextBody;if(this.triggerFieldRef.current){const{errorMessage:e}=dr(this.triggerFieldRef.current.value,c);this.triggerFieldRef.current.setCustomValidity(e);}const k=o$1(t).sort(((e,t)=>e.label.localeCompare(t.label)));let E=null;if(v)if(void 0===C){const e=f(t);E=e[0]?.id?[e[0]?.id]:null;}else E=C;const I=S!==g.trigger||!w&&x!==g.body||w&&this.state.isRichTextBodyDirty;return mt("form",{hidden:n,role:"row",onInput:e=>this.onSnippetInput(e),onSubmit:async e=>this.save(e,l),"data-is-unsaved":o,"data-is-in-conflict":r,"data-mode":this.state.mode,"data-is-dirty":I,"data-is-selected":e,onClick:e=>{"teams"!==i&&this.toggleRowCheckbox();}},mt("div",{role:"cell"},mt("input",{type:"checkbox",checked:e,value:g.id,hidden:o||"teams"===i}),mt("span",{hidden:!(o&&r)},mt(xo,null))),mt("div",{role:"cell",class:"shortcut-row-trigger"},u&&mt(ts,null),p&&mt(os,null),h&&mt(rs,null),mt("input",{type:"text",class:"trigger-field",placeholder:"Trigger",onClick:e=>{e.stopPropagation();},required:!0,disabled:"teams"===i,maxLength:255,ref:this.triggerFieldRef,value:S,"data-magical":"true","data-magical-prevent-expansion":"true",onFocus:()=>{Ro.dispatch(Fo(g.id));}})),mt("div",{role:"cell",class:"shortcut-row-body"},mt("div",{class:"body-field",onClick:e=>{e.stopPropagation();}},mt(pC,{initialValue:g.body,placeholder:"Shortcut Content",isDisabled:"teams"===i,isInPanel:!1,key:this.state.bodyKey,snippetId:g.id,useRichTextEditor:w,editorRefCallback:this.setRichTextEditorRef,bodyRefCallback:this.setBodyValueRef,onIncompatible:()=>this.setState({isRichTextEditorCompatible:!1}),onDirty:()=>{this.setState({mode:"edit",isRichTextBodyDirty:!0});},onFocusIn:()=>{Ro.dispatch(jo(g.id));},srcPagesWithVariables:f$1,srcPagesForClosedTabs:m,initialSrcBaseUrl:g.srcBaseUrls?.[0]?g.srcBaseUrls[0]:null,currentUrl:null})),mt("div",{class:"edit-controls",hidden:"edit"!==this.state.mode},v&&mt(us,{selectedOptions:E,onSelectCallback:e=>function(e,t){Ro.dispatch(So({snippetIds:[e.id],teamShareSelections:t}));}(g,e)}),mt("button",{type:"submit",class:"button-medium primary",onClick:e=>{const{showVariableSuggestion:t,selection:n}=gr({variableSuggestionSelection:l.variableSuggestionSelection,variableSuggestionPatterns:y,snippet:g,bodyValueRef:this.bodyValueRef,richTextEditorRef:this.richTextEditorRef,richTextEditorEnabled:this.props.richTextEditorEnabled,isRichTextEditorCompatible:this.state.isRichTextEditorCompatible,placeholdersEnabled:d,variablesEnabled:a,hasVariablesAvailable:s});t&&n&&(e.preventDefault(),this.showVariableSuggestion(e,l.variableSuggestionSelection,n)),e.stopPropagation();}},"Save"),mt("button",{type:"button",onClick:e=>{e.stopPropagation(),this.cancelEditing();},class:"button-medium secondary"},o&&"Discard",!o&&"Cancel")),mt("div",{class:"shortcut-labels-container",hidden:"teams"===i},k.map((e=>mt("span",{className:`shortcut-tag ${e.metadata?.tag?.color||""}`,key:e.id,title:e.label||"",onClick:e=>{e.stopPropagation();}},e.teamId?mt(wt,null,mt(zo,null),"Team"):e.label))))),mt("div",{role:"cell",class:"shortcut-row-buttons",onClick:e=>{e.stopPropagation();}},"teams"===this.props.mode&&mt("button",{type:"button",className:"actionable-icon shortcut-button",title:"Copy shortcut to workspace",onClick:()=>this.handleCloneTeamShortcutToWorkspace()},mt(bo$1,null)),"teams"!==this.props.mode&&mt(wt,null,mt("button",{type:"button",className:"actionable-icon shortcut-button",title:"Share Shortcut",onClick:()=>Ro.dispatch(ot({shortcutIds:[g.id]}))},mt(wo,null)),mt("button",{type:"button",className:"actionable-icon shortcut-button",title:"Remove Shortcut",onClick:()=>Ro.dispatch(at({shortcutIds:[g.id]}))},mt(Lo,null)))))}cancelEditing(){Ro.dispatch(ho$1(this.props.snippet.id)),Ro.dispatch(wo$1([this.props.snippet.id])),this.reset();}reset(){this.setState({bodyKey:pe(),mode:this.props.mode,isRichTextEditorCompatible:!0,trigger:null,isRichTextBodyDirty:!1}),this.richTextEditorRef.current&&HC(this.richTextEditorRef.current,this.props.snippet.body,!1);}showVariableSuggestion(e,t,a){const{snippet:s}=this.props;e.preventDefault();const n=t?.previouslyShownShortcutIds?[...t?.previouslyShownShortcutIds]:[];n.push(s.id),g({variableSuggestionSelection:{workspaceShortcutId:s.id,previouslyShownShortcutIds:n,selection:a||""}}),Ro.dispatch(jo(s.id));}onSnippetInput(e){if(!((e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)&&"checkbox"!==e.target.type))return;const t=e.target;if("edit"!==this.state.mode&&this.setState({mode:"edit"}),t.classList.contains("trigger-field")){const{trigger:e}=this.props.snippet;this.setState({trigger:t.value===e?null:t.value});}}async save(e,t){const{collections:a,isUnsaved:s,snippet:n,richTextEditorEnabled:o,teamsEnabled:r$1,draftTeamShareSelections:l}=this.props,c=!!o&&this.state.isRichTextEditorCompatible;try{const o=await Vr(this.bodyValueRef,e,this.richTextEditorRef,n,this.state.trigger,c);if(o){const{numSiteVariables:e,numPublicPlaceholders:i,numPrivatePlaceholders:c,numTotalPlaceholders:d}=hr(o);if(ni({type:"snippet.save",snippetId:o.id,isNew:s,wysiwygUsed:!!this.richTextEditorRef.current,isOnPanel:!1,numSiteVariables:e,numPublicPlaceholders:i,numPrivatePlaceholders:c,numTotalPlaceholders:d,teamShareSelections:l}),s){let e=a.map((e=>e.id));r$1&&l&&(e=e.concat(l)),Be(e,[o.id]);}else if(r$1&&l)Be(l,[o.id]);else if(r$1&&null===l){const e=f(a).map((e=>e.id));_e(e,[o.id]);}this.setState({isRichTextBodyDirty:!1,mode:"normal"}),document.getElementById("toast-success").textContent="Shortcut saved",!0!==t.shareFirstShortcut?.closed&&g({shareFirstShortcut:{shortcutId:o.id}}),t.variableSuggestionSelection?.workspaceShortcutId===n.id&&(ni({type:"variables-suggestion.options-shortcut.save-anyway"}),g({variableSuggestionSelection:{...t.variableSuggestionSelection,workspaceShortcutId:null}}));}}catch(e){document.getElementById("toast-error").textContent="Error saving. Please try again.",r.error(e);}}async handleCloneTeamShortcutToWorkspace(){try{const{savedShortcuts:e,duplicateShortcuts:t,conflictedShortcuts:a}=await ia([this.props.snippet]);a.length&&(En().textContent=1===a.length?`${a.length} copied shortcut trigger conflicts with a shortcut in your workspace. Rename and save.`:`${a.length} copied shortcuts' trigger conflict shortcuts in your workspace. Rename and save.`,Ro.dispatch(Do(ao.WORKSPACE))),e.length&&(xn().textContent=1===e.length?`Successfully saved ${e.length} shortcut to your workspace.`:`Successfully saved ${e.length} shortcuts to your workspace.`),t.length&&(kn().textContent=1===t.length?`${t.length} copied shortcut already exists. Original was kept.`:`${t.length} copied shortcuts already exist. Originals were kept.`),ni({type:"workspace.team.add",snippetIds:[this.props.snippet.id],newCount:e.length,duplicateCount:t.length,conflictedCount:a.length});}catch(e){En().textContent="Error saving copied shortcuts. Please try again.";}}}const hs=["/shared-ui-components/buttons.css","/shared-ui-components/tag-dropdown.css"],gs=oo`
.dropdown-menu {
  padding: 0;
}
.dropdown-item {
  flex-direction: row;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0;
  padding: 15px 12px 10px 10px;
  width: initial;
}
.dropdown-item .more-actions-icon {
  margin-left: 12px;
}
.dropdown-item .more-actions-icon > svg {
  transform: rotate(270deg);
}
`;function ms(e){const{customCss:t,toggle:a,toggleClass:s,options:n,onSelectCallback:o}=e;return mt(jp,{stylesheets:hs},mt(io,{css:t?gs.concat(t):gs}),mt(ue,{onSelect:e=>{o&&o(e);}},mt(ue.Toggle,{className:s},a),mt(ue.Menu,null,n.map((e=>mt(ue.Item,{key:e.id,eventKey:e.id},mt("span",{className:"dropdown-content"},e.content),e.hasMore&&mt("span",{className:"more-actions-icon"},mt(So$1,null))))))))}const fs=new he("options"),bs=new he("options");async function ys(){const e=Object.values(await fs.request("getSnippets"));Ro.dispatch(vo(e));}function vs(e){const t=e.filter((e=>!e.checked)).flatMap((e=>e.id)),a=e.filter((e=>e.checked)).flatMap((e=>e.id));Ro.dispatch(Po(a)),Ro.dispatch(Co$1(t)),Ro.dispatch(mo()),ni({type:"ate_filterTags"});}function Cs(e,t){t?Ro.dispatch(Eo(t)):Ro.dispatch(Io()),e();}function ws(){Ro.dispatch(mo()),Ro.dispatch(ko$1()),Ro.dispatch($o(""));}function Ss(){Ro.dispatch(Do(ao.WORKSPACE));}function xs(e,t){let a=e;0===e.length&&(a=t),Ro.dispatch(ot({shortcutIds:a}));}re("defaultSnippets").subscribe(ys),re("snippets").subscribe(ys),re("snippetCollections").subscribe((async function(){const e=Object.values(await Xn("snippetCollections")||{});Ro.dispatch(bo(e));}));const ks=mt(wt,null,mt(Go,null),"Share"),Es=oo`
  .sharing-icon {
      width: 30px;
      display: flex;
      justify-content: center;
  }
`,Is={id:"1",content:mt(wt,null,mt("span",{className:"sharing-icon"},mt(zo,null)),mt("span",{className:"sharing-details"},"Add to team library"))},Ts={id:"2",content:mt(wt,null,mt("span",{className:"sharing-icon"},mt(ho,null)),mt("span",{className:"sharing-details"},"Share via link or email")),hasMore:!0},Rs=[Is,Ts];function Ps(e){const{teamId:t}=e;return mt("div",{class:"no-shortcuts"},mt(Kr,null),mt("div",{class:"no-shortcuts-text"},mt("span",{class:"no-shortcuts-heading"},"No shortcuts yet"),mt("span",{class:"no-shortcuts-body",hidden:!t},mt("span",null,mt("span",{class:"workspace-link",onClick:Ss},"Go to your workspace "),"to share your"),mt("span",null,"shortcuts with your team")),mt("span",{class:"no-shortcuts-body",hidden:!!t},"Get started by creating a shortcut")))}function Os(e){const{teamId:t$1}=e,a=to((e=>e.global.teamSnippets)),{saved:s,unsaved:n$1,selectedIds:o,draftTeamShareSelections:r,collectionsForUnsavedSnippets:i,filteredCollectionIds:l,unsavedInConflictIds:c,savedInConflictIds:d,newlySavedIds:u,lastEditedShortcutBody:p,lastEditedShortcutTrigger:h,searchQuery:g}=to((e=>e.optionsPage)),m=to((e=>e.global.config.numShortcutsToGateCreate)),[f$1,b]=nn$2(!1),y=un$2(null),v=un$2(null),C=to((e=>e.global.snippetCollections)),w=to((e=>e.global.notifications)),S=to((e=>e.global.userInfo.email)),x=to((e=>e.global.userInfo.onboarding)),k=to((e=>e.global.userInfo.featureFlags.teamsEnabled))||!1,E=to((e=>e.global.userInfo.teams)),I=to((e=>e.global.userInfo.featureFlags.signInToCreateShortcutsEnabled)),T=to((e=>e.global.userInfo.featureFlags.shareShortcutsEnabled)),R=to((e=>e.global.userInfo.featureFlags.variablesEnabled))||!1,P=to((e=>e.global.userInfo.featureFlags.placeholderVariablesEnabled)),O=to((e=>e.global.config.shortcuts.variableSuggestionPatterns)),M=to((e=>e.global.srcPagesForOpenTabs?e.global.srcPagesForOpenTabs.filter((e=>e.srcMatches.length>0)):[])).length>0,F=to((e=>e.dialogs.shareShortcutsDialog)),A=s.map((e=>e.trigger)),{richTextEditorEnabled:N}=Qo(),D=to((e=>e.global.srcPagesForOpenTabs)),j=to((e=>e.global.srcPagesForClosedTabs)),B=t$1?[...a[t$1]||[]]:[],_=f(C).map((e=>e.id)),L=k&&E&&E.length>0,q=N||!1,U=t(C),V=D.filter((e=>e.srcMatches.length>0)),W=!!R&&!x?.optionsShortcutVariableHelpClosed,H=!R&&!x?.optionsShortcutTriggerHelpClosed,z=n$1.filter((e=>!c.includes(e.id))).map((e=>{const t=o.includes(e.id),a=n(e.id,U,C,i);return mt(ps,{key:e.id,isUnsaved:!0,isInConflict:!1,otherSavedTriggers:A,snippet:e,checked:t,hasVariablesAvailable:M,mode:"edit",notifications:w,collections:a,placeholdersEnabled:P,variableSuggestionPatterns:O,variablesEnabled:R,richTextEditorEnabled:q,showVariableHelp:W&&p===e.id,showTriggerHelp:H&&h===e.id,showVariableSuggestion:w.variableSuggestionSelection?.workspaceShortcutId===e.id,srcPagesWithVariables:V,srcPagesForClosedTabs:j,teamsEnabled:k,draftTeamShareSelections:r[e.id]})})),J=n$1.concat(s).filter((e=>c.includes(e.id)||d.includes(e.id))).sort(((e,t)=>e.trigger.localeCompare(t.trigger,void 0,{sensitivity:"base",usage:"sort"}))).map((e=>{const t=o.includes(e.id),a=!!n$1.find((t=>t.id===e.id)),s=A.indexOf(e.trigger),r=[...A];-1===s||a||r.splice(s,1);const l=a?"edit":"normal",c=n(e.id,U,C,i);return mt(ps,{key:e.id,isUnsaved:a,isInConflict:!0,otherSavedTriggers:r,snippet:e,checked:t,hasVariablesAvailable:M,mode:l,collections:c,notifications:w,variableSuggestionPatterns:O,placeholdersEnabled:P,variablesEnabled:R,richTextEditorEnabled:q,showVariableHelp:W&&p===e.id,showTriggerHelp:H&&h===e.id,showVariableSuggestion:w.variableSuggestionSelection?.workspaceShortcutId===e.id,srcPagesWithVariables:V,srcPagesForClosedTabs:j,teamsEnabled:k})})),Z=B.sort(((e,t)=>e.trigger.localeCompare(t.trigger,void 0,{sensitivity:"base",usage:"sort"}))).map((e=>{const t=n(e.id,U,C,i);return mt(ps,{key:e.id,isUnsaved:!1,isInConflict:!1,otherSavedTriggers:[],snippet:e,checked:!1,mode:"teams",placeholdersEnabled:P,notifications:w,hasVariablesAvailable:M,variablesEnabled:R,collections:t,richTextEditorEnabled:q,showVariableHelp:!1,showTriggerHelp:!1,showVariableSuggestion:!1,variableSuggestionPatterns:O,srcPagesWithVariables:[],srcPagesForClosedTabs:[],teamsEnabled:k})}));let K=s.filter((e=>{const t=n(e.id,U,C).flatMap((e=>e.id));return 0===l.length||l.some((e=>t.includes(e)))}));g&&(K=De(K,U,g));const Y=K.map((e=>e.id)),Q=s.filter((e=>!d.includes(e.id))).map((e=>{const t=A.indexOf(e.trigger),a=[...A];-1!==t&&a.splice(t,1);const s=u.includes(e.id)?"added":"normal",n$1=o.includes(e.id),i=n(e.id,U,C);return mt(ps,{hidden:!Y.includes(e.id),key:e.id,isUnsaved:w.variableSuggestionSelection?.workspaceShortcutId===e.id,isInConflict:!1,mode:s,hasVariablesAvailable:M,otherSavedTriggers:a,snippet:e,checked:n$1,collections:i,variablesEnabled:R,notifications:w,placeholdersEnabled:P,variableSuggestionPatterns:O,richTextEditorEnabled:q,showVariableHelp:W&&p===e.id,showTriggerHelp:H&&h===e.id,showVariableSuggestion:w.variableSuggestionSelection?.workspaceShortcutId===e.id,srcPagesWithVariables:V,srcPagesForClosedTabs:j,teamsEnabled:k,draftTeamShareSelections:r[e.id]})})),X=Y.length>0&&o.length===Y.length,ee=o.length>0&&o.length<Y.length,te=o$1(C).filter((e=>!e.teamId)).map((e=>({id:e.id,label:e.label,color:e.metadata?.tag?.color,checked:o.length>0&&o.filter((t=>e.snippetIds.includes(t))).length===o.length,indeterminate:o.length>0&&o.filter((t=>e.snippetIds.includes(t))).length>0&&o.filter((t=>e.snippetIds.includes(t))).length<o.length}))),ae=o$1(C).map((e=>({id:e.id,label:e.teamId?"Team":e.label,icon:e.teamId?mt(zo,null):void 0,color:e.metadata?.tag?.color,checked:l.includes(e.id),indeterminate:!1}))),se=s.filter((e=>!Y.includes(e.id)&&d.includes(e.id))),de=s.length-se.length-Y.length,ue=!!s.length&&de===s.length-se.length;let pe=z.length+Q.length+J.length;t$1&&(pe=Z.length);const[he,ge]=Qn$1.useState(!1),me=()=>ge(!0),[fe,be]=Qn$1.useState(!1),ye$1=()=>be(!0),ve=!S&&(s.length>=20||I&&s.length>=m),{data:Ce,loading:we}=nC((async()=>ve?bs.request("isServerReachable"):null),[ve]);return on$1((()=>{f$1&&v.current.focus();}),[f$1]),mt(wt,null,mt("menu",{id:"bulk-actions"},mt("div",{hidden:!!t$1},mt("span",null,mt("input",{id:"select-all-shortcuts",type:"checkbox",checked:X,ref:e=>{e&&(e.indeterminate=ee);},onChange:e=>{X?Ro.dispatch(go(Y)):Ro.dispatch(yo(Y));}}),mt("fieldset",null,mt("button",{id:"new-snippet",class:"button-small primary",onClick:()=>{var e;!we&&Ce&&ve?(Ro.dispatch(Qe()),ni({type:"feature-gate.create.show"})):(e=_,ni({type:"ate_addSnippet"}),document.getElementById("snippets").scrollIntoView({behavior:"smooth"}),Ro.dispatch(_o({snippet:{},teamShareSelections:e})));}},mt(qo,null),"Create shortcut"),T&&!L&&mt("button",{class:"secondary button-small",onClick:()=>xs(o,Y)},ks),T&&L&&mt(ms,{options:Rs,toggle:ks,toggleClass:"secondary button-small no-caret",customCss:Es,onSelectCallback:e=>{e===Is.id?function(e,t){t?.length&&e?.length?(Be(t,e),xn().textContent=`Added ${1===e.length?"1 shortcut":`${e.length} shortcuts`} to team library`,ni({type:"workspace.share.team",shortcutCount:e.length,teamShareSelections:t})):kn().textContent="Please select a shortcut first";}(o,_):e===Ts.id&&xs(o,Y);}}),mt(ce,{tagData:te,onApply:e=>ye(e,o),onCreate:()=>Cs(me),onDelete:e=>function(e,t){Ro.dispatch(Eo(t)),e();}(ye$1,e),onEdit:e=>Cs(me,e),options:{label:"Tags",showCreate:!0,showDelete:!0,showEdit:!0,toggleClass:"secondary button-small no-caret",icon:mt(No,null),isSelectable:o.length>0}}),mt("button",{class:"tertiary-muted button-small",disabled:0===o.length,onClick:()=>{0!==o.length&&Ro.dispatch(at({shortcutIds:o}));}},mt(Lo,null),"Delete"))),mt(ce,{tagData:ae,onApply:vs,onCreate:()=>Cs(me),options:{label:"Filter",toggleClass:"button-small tertiary no-caret",icon:mt(_o$1,null),isSelectable:!0}}),mt("button",{ref:y,class:"search-button tertiary-muted",onClick:()=>{f$1?y.current.blur():y.current.focus(),b(!f$1),ws();}}," ",mt(Zo,null)," ")),f$1?mt("input",{id:"searchbar",value:g,ref:v,"data-magical":"true","data-magical-prevent-expansion":"true",placeholder:"Search Shortcuts",onChange:e=>{const t=e.target?e.target.value:"";Ro.dispatch($o(t)),Ro.dispatch(mo());}}):""),!t$1&&de>0&&mt("div",{class:"filter-banner"},de," shortcuts hidden ",mt("a",{class:"tertiary button-small",onClick:ws},"Reset")),mt("section",{id:"snippets",role:"table"},mt("header",{role:"row"},mt("div",{role:"columnheader"},"Trigger"),mt("div",{role:"columnheader"},"Content")),ue&&mt("div",{class:"no-filter-results"},mt("div",{class:"no-filter-results-text"},mt("span",{class:"no-filter-heading"},"No results"),mt("span",{class:"no-filter-body"},"Try fewer tag filters."),mt("span",{class:"no-filter-body"},"Or try another search term.")),mt("div",null,mt($r,null))),!ue&&pe>0&&mt("div",{role:"rowgroup"},!t$1&&z,!t$1&&J,!t$1&&Q,t$1&&Z),!ue&&0===pe&&mt(Ps,{teamId:t$1})),!t$1&&mt(wt,null,mt(Za,{showModal:he,onCloseCallback:()=>ge(!1)}),mt(Ya,{showModal:fe,onCloseCallback:()=>be(!1)}),F.showModal&&mt(oa,null)))}const Ms=oo`
  dialog {
    max-width: 500px;
    padding-bottom: 0;
  }

  .export-share-copy {
    padding-bottom: 1em;
    margin-right: 20px;
  }

  #export-link-copied {
    color: var(--magical-green-60);
    font-size: 12px;
    margin-top: 8px;
  }

  .export-share-content {
    display: flex;
  }

  .export-share-img {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
  }
`;function Fs(e){const{onCloseCallback:t}=e,{config:{shareShortcutsUrl:a},snippets:s,userInfo:n}=to((e=>e.global)),[o,r]=Qn$1.useState(""),i=s.map((e=>e.id));on$1((()=>{!async function(){const{id:e}=await sa(i);r(`${a}?shareId=${e}`.toString());}();}),[a,...i]);const c=mt(wt,null,mt("a",{href:Dn,target:"_blank",rel:"noreferrer"},"Join now or sign in")," for automatic backups ✨ ",mt("a",{href:en$1("privacy-and-safety"),target:"_blank",rel:"noreferrer"},"Read more.")),d=mt(wt,null,"All your shortcuts are automatically backed up to your account. ✨ ",mt("a",{href:en$1("privacy-and-safety"),target:"_blank",rel:"noreferrer"},"Read more."));return mt(Jt,{title:"Export shortcuts",showModal:!0,onCloseCallback:t},mt(wt,null,mt(io,{css:Ms}),mt("p",null,"Want to backup your shortcuts? ",n.email?d:c),mt("hr",null),mt("div",{class:"export-share-content"},mt("div",{class:"export-share-copy"},mt("h3",null,"Sharing shortcuts?"),mt("p",null,"Copy the link to share all your shortcuts or select specific shortcuts to share from your workspace."),mt(Gt,{url:o,tracking:{type:"snippet.exportAll.copyShareLink"}})),mt("div",{class:"export-share-img"},mt(qr,null)))))}const As=new he("import-confirmation-dialog"),Ns=new he("import-confirmation-dialog");async function Ds(e,t){try{ni({type:"ate_importOverwrite"});const a=_s(t),s="number"==typeof a.version?a.version:1,n=1===s?a:a.shortcuts;await async function(e,t){const a=Object.keys(e),s=Object.values(await Ns.request("getSnippets")),n=Object.values(s).map((e=>e.trigger)),r=o.difference(n,a),i=Object.values(s).filter((e=>r.includes(e.trigger)&&e.id)).map((e=>e.id)),l=[];for(const[a,n]of Object.entries(e)){const e=Object.values(s).find((e=>a===e.trigger));l.push({...Bn(),id:e?.id||pe(),trigger:a,body:t<3?rn$1(nn$1(n)):n});}await As.request("import",l,i);}(n,s),e&&e(),xn().textContent="Success importing shortcuts";}catch(e){throw r.error("Error importing JSON",e),En().textContent="Error importing shortcuts",new Error("Import error")}}function js(e){const{showModal:t,onCloseCallback:a,onSubmitCallback:s,jsonToImport:n}=e;return mt(Jt,{title:"Overwrite all current shortcuts with imported shortcuts?",showModal:t,onSubmitCallback:()=>{Ds((()=>{s(),a();}),n);},onCloseCallback:a},mt(wt,null,mt("p",null,"We will delete the current shortcuts and immediately save the imported shortcuts."),mt("div",null,mt("button",{className:"button-medium primary",type:"submit"},"Yes, overwrite and save")," ",mt("button",{className:"button-medium secondary",type:"reset",onClick:a},"No, cancel"))))}const Bs=oo`
  textarea {
    width: 100%;
    min-height: 30vh;
  }

  textarea:invalid {
    border: 1px solid #CE0000;
  }

  #import-error {
    color: #CE0000;
    visibility: hidden;
  }

  textarea:invalid ~ #import-error {
    visibility: visible;
  }
`;function _s(e){try{const t=JSON.parse(e);if(Array.isArray(t))throw r.error("Error parsing JSON. Should not be an array."),new Error("JSON format error");return t}catch(e){throw r.error("Error parsing import JSON",e),ni({type:"ate_importOverwrite_jsonError"}),new Error("JSON format error")}}function Ls(e){e.preventDefault();}function qs(e){const{onCloseCallback:t}=e,{saved:a}=to((e=>e.optionsPage)),s=a.find((e=>void 0!==e.synced&&!1===e.synced)),n={};for(const e of Object.values(a))n[e.trigger]=e.body;const o={version:3,shortcuts:n},r=JSON.stringify(o,void 0,2),[i,l]=Qn$1.useState(!1),[c,d]=Qn$1.useState(r);return mt(wt,null,mt(Jt,{title:s?"Import or export shortcuts":"Import shortcuts",showModal:!0,onChangeCallback:e=>{d(e.target?e.target.value:""),function(e){if(e.target instanceof HTMLTextAreaElement){const t=e.target;try{_s(t.value),t.setCustomValidity("");}catch(e){t.setCustomValidity(e.message);}}}(e);},onCloseCallback:t,onSubmitCallback:e=>{l(!0),e.preventDefault();}},mt(wt,null,mt(io,{css:Bs}),mt("div",{class:"import-dialog-container"},mt("div",{class:"json-section"},s&&mt("p",null,"Do you want to export your shortcuts or share them with others? Copy the text below."),mt("p",null,"Do you want to import all new shortcuts? Delete the existing text below and paste your shortcuts in JSON format. This will override existing shortcuts. Add shortcuts by appending to the existing text."),mt("p",null,"Have a CSV of shortcuts? ",mt("a",{id:"csv-converter",href:"https://shancarter.github.io/mr-data-converter/",target:"_blank",rel:"noopener noreferrer",title:"CSV or Tab to JSON"},"Use this service to convert"),". Then import."),mt("textarea",{id:"import-json",autoFocus:!0,required:!0,value:c,onInvalid:Ls}),mt("div",{id:"import-error"},mt("strong",null,"Error:")," There's an error in this JSON code.",mt("a",{id:"json-validator",href:"https://jsonformatter.curiousconcept.com/",target:"_blank",rel:"noopener noreferrer",title:"JSON Validator"},"Please use this service to validate your JSON.")),mt("div",null,mt("button",{className:"button-medium primary",type:"submit"},"Import")," ",mt("button",{className:"button-medium secondary",type:"reset",onClick:t},"Cancel")))))),mt(js,{showModal:i,onSubmitCallback:t,onCloseCallback:()=>l(!1),jsonToImport:c}))}const Us=new he("shareApp"),Vs=oo`
  dialog {
    min-width: 500px;
  }
`,$s=oo`
  dialog {
    background-color: var(--magical-gray-00);
    min-width: 800px;
  }
`,Ws=()=>{Ro.dispatch(rt()),Sn(["dialog"]);};function Hs(){const e=to((e=>e.global.referrals)),t=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled)),a=to((e=>e.global.userInfo.featureFlags.referralCreditsExperimentSequenceEnabled)),s=to((e=>e.global.userInfo.featureFlags.referralCreditsProBetaDefaultSequenceEnabled));on$1((()=>{ni({type:"workspace.share.show",referralCount:e.length,entryPoint:"shareApp"});}),[e.length]);const n=ne({referralCreditsEnabled:t,referralCreditsExperimentSequenceEnabled:a,referralCreditsProBetaDefaultSequenceEnabled:s}).toString(),o=to((e=>e.global.userInfo.referralCode));return mt(Jt,{title:void 0,showModal:!0,onCloseCallback:Ws},mt(wt,null,mt(io,{css:t?$s:Vs}),mt(Xt,{header:"💚 Share the magic!",shareUrl:n,copyUrlTracking:{type:"workspace.share.copy",referralCount:e.length,entryPoint:"shareApp"},onSendEmailClick:async n=>{const r=await Us.request("shareAppByEmail",{emails:n,referralCode:o,utmCampaign:ee({referralCreditsEnabled:t,referralCreditsExperimentSequenceEnabled:a,referralCreditsProBetaDefaultSequenceEnabled:s})});return r&&ni({type:"workspace.share.email",entryPoint:"shareApp",referralCount:e.length,emailCount:n.length}),r}})))}const zs=()=>{Ro.dispatch(et());};function Js(){const e=to((e=>e.global.totalTimeSaved)),t=to((e=>e.global.userInfo.featureFlags.referralCreditsEnabled));return mt("div",{class:"sidebar-content-block",id:"time-saved"},mt("div",{id:"time-saved-emoji"},mt(Po$1,null)," ",e.emoji),mt("p",{id:"time-saved-text"},"You've saved ",mt("strong",null,e.timeSaved,"+ ",e.unit)),mt("p",null,e.message),!t&&mt("button",{class:"button-medium secondary full-width",onClick:zs},"Invite people"))}function Zs(e){const{teamId:t}=e,a=to((e=>e.global.recoveryState)),s=to((e=>e.global.totalTimeSaved)),n=to((e=>e.global.userInfo)),o=to((e=>e.global.referrals)),{featureFlags:r,email:i,teams:l}=n,c=to((e=>e.optionsPage.saved)),d=to((e=>e.dialogs.shareAppDialogOpen)),u=c.find((e=>void 0!==e.synced&&!1===e.synced));let p;t&&l&&(p=l.find((e=>e.id===t)));const[h,g]=Qn$1.useState(!1),[m,f]=Qn$1.useState(!1),b=!i&&r.joinNowCTACohort===On.SIDEBAR,y=Gp(n,o.length),v=mt("div",{class:"sidebar-content-block",id:"referral-credits"},mt("h2",null,"Referral credits"),mt(uL,{isShortened:!0,showGif:!1}),mt("button",{class:"button-medium secondary",onClick:zs},"Invite people")),C=mt("div",{class:"sidebar-content-block",id:"join-now-sidebar"},mt("h1",null,"🙀 Don’t lose your shortcuts. Join for free!"),mt("div",{class:"sidebar-join-row"},mt(ko,null),mt("p",null,"Get automated backups")),mt("div",{class:"sidebar-join-row"},mt(ko,null),mt("p",null,"Tag your shortcuts")),mt("div",{class:"sidebar-join-row"},mt(ko,null),mt("p",null,"Share with your team")),mt("div",{class:"sidebar-join-row"},mt(ko,null),mt("p",null,"Customize your settings")),mt("button",{id:"sidebar-content-join-now",class:"button-medium primary full-width",onClick:()=>{Ro.dispatch(Ao(!0)),ni({type:"signup.sidebar-join"});}},"Join now in seconds")),w=mt("nav",null,a?.showRecoveryButton&&mt("button",{id:"import-recover-button",class:"button-small tertiary-muted",onClick:In.showRecoveryModal},"Recover"),mt("button",{id:"import",class:"button-small tertiary-muted",onClick:()=>{ni(u?{type:"ate_importExport"}:{type:"snippet.import"}),g(!0);}},u?"Import/export shortcuts":"Import"),!u&&mt("button",{id:"export",class:"button-small tertiary-muted",onClick:()=>{ni({type:"snippet.exportAll"}),f(!0);}},"Export"));return mt(wt,null,mt("section",{id:"sidebar"},mt("div",{hidden:!!t},y&&mt(Bp,{isOnPanel:!1}),b&&C,r.referralCreditsEnabled&&v),t&&p&&mt("div",{class:"team-sidebar sidebar-content-block"},mt("div",{class:"team-header"},"Team"),mt("div",{class:"team-info"},p?.photoUrl&&mt("img",{src:p?.photoUrl}),p?.name)),!!s.timeSaved&&mt(Js,null),mt("div",{hidden:!!t},w)),h&&mt(qs,{onCloseCallback:()=>g(!1)}),m&&mt(Fs,{onCloseCallback:()=>f(!1)}),d&&mt(Hs,null))}const Ks={origins:["http://*/*","https://*/*"]};async function Gs(){const e=await a.browser.permissions.request(Ks);ni({type:"ate_hostPermissionsResponse",allow:e});}function Ys(){const[e,t]=nn$2(!0),[s,n]=nn$2(!1);return on$1((function(){e||s||ni({type:"ate_hostPermissionsShow"});}),[e,s]),on$1((()=>{async function e(){const e=await a.browser.permissions.contains(Ks);t(e);}return a.browser.permissions.onAdded.addListener(e),a.browser.permissions.onRemoved.addListener(e),e(),()=>{a.browser.permissions.onAdded.removeListener(e),a.browser.permissions.onRemoved.removeListener(e);}}),[]),e||s?null:mt("section",{id:"host-permissions-section",class:"options-card warning"},mt("h2",null,"Something's not right"),mt("p",null,"Magical won't work everywhere based on your current settings."),mt("button",{class:"button-medium primary",onClick:Gs},"Enable Now"),"  ",mt("button",{class:"button-medium secondary",onClick:function(){ni({type:"ate_hostPermissionsSkip"}),n(!0);}},"Not Now"))}const Qs=["shared-ui-components/banners.css","shared-ui-components/buttons.css"];function Xs(){const[e,t]=nn$2(!1),a=to((e=>e.optionsPage.showSignup)),{snippets:s,userInfo:{featureFlags:n,email:o}}=to((e=>e.global)),r=s.some((e=>!1===e.synced)),i=!o&&!a&&n.joinNowCTACohort===On.BANNER;return mt(jp,{class:"banner-container",stylesheets:Qs},r&&!e&&mt("div",{class:"banner warning"},mt(To,null),mt("span",{class:"banner-title"},"Working Offline · "),mt("span",{class:"banner-secondary-copy"},"Shortcuts can’t be backed up and may be lost. ",mt("a",{target:"_blank",href:"https://www.getmagical.com/autotextexpander/error-working-offline",rel:"noreferrer"},"Learn how to fix this")),mt("button",{class:"actionable-icon close",onClick:()=>{t(!0);}},mt(Ro$1,null))),i&&(!r||e)&&mt("div",{class:"banner warning"},mt(To,null),mt("span",{class:"banner-title"},"You're at risk of losing shortcuts · "),mt("span",{class:"banner-secondary-copy"},"Join to get backups for free ·",mt("button",{id:"sidebar-content-join-now",onClick:()=>{Ro.dispatch(Ao(!0)),ni({type:"signup.sidebar-join"});}},mt("u",null,"Join now in seconds")))))}const en=new he("header");function tn(e){const[t,a]=nn$2(!1),{userInfo:s}=e,n=s&&s.email;let o="";return s?.firstName?o=s.firstName.charAt(0).toUpperCase():s?.lastName&&(o=s.lastName.charAt(0).toUpperCase()),mt(jp,{class:"profile-circle-container",stylesheets:["/shared-ui-components/profile-circle.css"]},mt(wt,null,t&&mt("div",{id:"profile-overlay",onClick:()=>a(!1)}),mt("button",{id:"profile",class:`profile-circle ${t?"profile-active":null}`,onClick:()=>{a(!t);}},o?mt("p",{id:"profile-name"},o):mt(Bo$1,null),t&&mt("div",{id:"profile-dropdown"},mt("div",{id:"dropdown-title"},n?s?.email:"Guest Magician"),mt("hr",{class:"dropdown-separator"}),mt("div",{class:"dropdown-option",onClick:e=>{e.stopPropagation(),a(!1),ni({type:"settings.modal.show",cta:s.email?"adjustSettings":"signIn"}),Ro.dispatch(Je());}},"Settings"),n&&mt("div",{class:"dropdown-option",onClick:e=>{e.stopPropagation(),a(!1),en.notification("logOut");}},"Sign out"))),!n&&mt("button",{id:"sign-up-profile-circle",class:"profile-circle-button",onClick:()=>{Ro.dispatch(Ao(!0)),ni({type:"signup.nav"});}},"Sign in")))}const an=()=>{Sn(["page"]),Ro.dispatch(xo$1());};function sn(){const e=to((e=>e.optionsPage.showSignup)),t=to((e=>e.global.config.extensionProBetaOnboardingFrameURL)),a=to((e=>e.global.config.extensionOnboardingFrameURL)),s=to((e=>e.global.userInfo));return mt("nav",{class:"topbar"},mt("div",{class:"navbar"},mt("div",{className:s.featureFlags.teamsEnabled?"nav-content extended-nav":"nav-content"},mt("button",{class:"nav-logo-center",onClick:an},mt(Dr$1,null)),mt("div",{class:"nav-space"}),!e&&mt("div",{class:"nav-options"},mt("a",{class:"button-small tertiary-muted",href:s.featureFlags.variablesEnabled?t:a,target:"_blank",rel:"noopener noreferrer",onClick:()=>ni({type:"navbar.get-started"})},"Get Started"),mt("a",{class:"button-small tertiary-muted",href:"https://www.getmagical.com/help",onClick:()=>ni({type:"navbar.help-center"}),target:"_blank",rel:"noopener noreferrer"},"Help center"),mt("a",{class:"button-small tertiary-muted",href:"https://community.getmagical.com/",onClick:()=>ni({type:"navbar.community"}),target:"_blank",rel:"noopener noreferrer"},"Community"),mt("a",{class:"button-small tertiary-muted",href:"https://www.getmagical.com/change-log",onClick:()=>ni({type:"navbar.see-whats-new"}),target:"_blank",rel:"noopener noreferrer"},"See what's new"),mt(tn,{userInfo:s})))),mt(Xs,null))}function nn(e){const{frameUrl:t}=e;return mt("div",{class:"options-promo-frame"},mt("button",{class:"actionable-icon close-dialog-button options-promo-frame-close",type:"reset",onClick:()=>{ni({type:"options.iframe-close"}),g({closedPromoFrameUrl:t});}},mt(ao$1,null)),mt("iframe",{id:"promo-iframe",class:"options-card",src:t}))}const on=oo`
  iframe {
    min-width: 450px;
    border: none;
    min-height: 700px;
    overflow: hidden;
    width: 100%;
  }
  .blocked-server {
    margin-top: 150px;
    text-align: center;
  }
  .blocked-server-content {
    display: flex;
    justify-content: center;
  }
  .blocked-server-graphic {
    min-width: 160px;
  }
  .blocked-server-text { 
    max-width: 350px;
  }
  .continue-as-guest {
    display: flex;
    justify-content: center;
    width: 100%;
  }
`,rn=new URL(Dn);rn.searchParams.append("iframe","true");const ln=rn.toString();function cn(e){const t=to((e=>e.global.userInfo.onboarding)),a=to((e=>e.global.userInfo.featureFlags.variablesEnabled)),s=to((e=>e.global.config.extensionOnboardingFrameURL)),n=to((e=>e.global.config.extensionProBetaOnboardingFrameURL)),o=to((e=>e.global.userInfo.featureFlags.forceSignUpEnabled)),{isServerReachable:r,timesReloaded:i}=e;on$1((()=>ni({type:"signup.modal-show"})),[]);return r?mt(wt,null,mt(io,{css:on}),mt("div",null,mt("iframe",{src:ln,scrolling:"no"}),!o&&mt("div",{class:"continue-as-guest"},mt("button",{class:"button-small tertiary-muted",onClick:()=>{ni({type:"signup.modal-continue-as-guest",timesReloaded:i}),Ro.dispatch(so(!1)),Ro.dispatch(Ao(!1)),a&&!t?.checklist?.variablesIntro?Ht(n):a||t?.checklist?.insertSnippet||Ht(s),g({timesReloaded:1});},target:"_blank",rel:"noopener noreferrer"},"Continue as Guest")))):(ni({type:"signup.blocked-server"}),mt(wt,null,mt(io,{css:on}),mt("div",{class:"blocked-server"},mt("h2",null,"We're having trouble reaching our servers..."),mt("div",{class:"blocked-server-content"},mt("div",{class:"blocked-server-graphic"},mt(eo,null)),mt("div",{class:"blocked-server-text"},mt("p",null,"Are you on a VPN or have an ad blocker?",mt("br",null),"These can interfere with our connection."),mt("a",{href:"mailto:hello@getmagical.com",target:"_blank",rel:"noreferrer"},"Email us")," or ",mt("a",{href:zn,target:"_blank",rel:"noreferrer"},"post in our community")," to troubleshoot.")),mt("button",{class:"button-medium tertiary-muted",onClick:()=>{ni({type:"signup.blocked-server.back",timesReloaded:i}),Ro.dispatch(xo$1());}},"Go back"))))}function dn(e){e instanceof AnimationEvent&&"toast-out"===e.animationName&&e.target instanceof Element&&(e.target.textContent="");}function un(e){return mt("div",{id:e.id,onAnimationEnd:dn,class:"toast",role:"alert"})}const pn=new he("options-app"),hn=new he("options-app");function gn(){return mt(Qn$1.StrictMode,null,mt(Xe,{store:Ro},mt(bn,null)))}function mn(){return mt("footer",null,mt("a",{class:"button-small tertiary-muted",href:"https://www.getmagical.com/autotextexpander/terms-of-service",target:"_blank",rel:"noopener noreferrer"},"Terms of Service"),mt("a",{class:"button-small tertiary-muted",href:"https://www.getmagical.com/autotextexpander/privacy-policy",target:"_blank",rel:"noopener noreferrer"},"Privacy Policy"))}const fn=[{id:ao.WORKSPACE,label:"Your workspace",icon:mt(Ko,null)},{id:ao.TEAMS,label:"Team library",icon:mt(zo,null)}];function bn(){const e=to((e=>e.optionsPage.activeTab)),t=to((e=>e.optionsPage.showSignup)),s=to((e=>e.optionsPage.clickedSignupCTA)),n=to((e=>e.dialogs.featureGateCreateDialogOpen)),o=to((e=>e.dialogs.deleteShortcutsDialog.showModal)),r=to((e=>e.dialogs.settingsDialogOpen)),i=to((e=>e.dialogs.topShortcutDialog.showModal)),{email:l,onboarding:c,featureFlags:u,teams:p}=to((e=>e.global.userInfo)),h=to((e=>e.global.sharedCollectionId)),g=to((e=>e.global.notifications)),m=to((e=>e.global.config.signupDialogReloadThreshold)),f=to((e=>e.global.config.optionsPromoFrameUrl)),b=to((e=>e.global.config.optionsPromoProBetaFrameUrl)),y=to((e=>e.global.totalTimeSaved));nC((async()=>{if(p?.length&&e===ao.TEAMS){const e=p[0]?.id;return e?(ni({type:"workspace.team.impression",teamId:e}),hn.request("syncTeamSnippets",e)):null}return null}),[e,p]);const v=(g.timesReloaded??0)%m==0,{data:C,loading:w}=nC((async()=>l||!v&&!s?null:pn.request("isServerReachable")),[v,s]),S=!l&&(s||!!(C&&v));S&&!t?Ro.dispatch(so(!0)):!S&&t&&Ro.dispatch(so(!1));const x=un$1(y),k=!g.nextTimeSavedThreshold&&x>900||g.nextTimeSavedThreshold&&x>g.nextTimeSavedThreshold,E=a.browser.runtime.getURL("assets/animated-logo.gif"),I=u.optionsPromoFrameEnabled&&f&&f.length>0&&g.closedPromoFrameUrl!==f,T=u.teamsEnabled&&p&&p.length>0,R=e===ao.TEAMS&&T?p[0]?.id:void 0;let P=mt("div",{id:"container"},mt("main",null,T&&mt("div",{id:"options-tab-list"},mt(co,{tabs:fn})),mt("div",{class:"options-main"},mt("div",{hidden:e!==ao.WORKSPACE&&T},I&&mt(nn,{frameUrl:u.variablesEnabled?b:f}),mt(Ys,null)),mt("div",{hidden:!!R},mt(Os,null)),T&&R&&mt(Os,{teamId:R}),mt(mn,null)),mt("div",{id:"sidebar"},mt(Zs,{teamId:R}))),!!h&&mt(ha,null),n&&mt(xa,null),u.shareShortcutsEnabled&&g.shareFirstShortcut?.shortcutId&&!0!==g.shareFirstShortcut?.closed&&mt(Ba,null),o&&mt(Ca,null),k&&mt(Va,null),r&&mt(Aa,null),i&&mt(Wa,null),u.acceptShortcutsOnInstallEnabled&&!c?.checklist?.acceptShortcuts&&!h&&mt(fa,null),u.proBetaUpgradeExperienceEnabled&&!(c?.proBetaUpgradeModalClosed||c?.proBetaUpgradeNotificationMade)&&mt(Ta,null),mt(un,{id:"toast-info"}),mt(un,{id:"toast-success"}),mt(un,{id:"toast-error"}));return w?P=mt("div",{class:"options-loading"},mt("div",null,mt("img",{class:"options-loading-gif",src:E}),mt("h2",null,"Loading..."))):t&&(P=mt(cn,{isServerReachable:C,timesReloaded:g.timesReloaded||0})),mt(wt,null,mt(sn,null),P)}var yn=s((function(e$1){!function(){var a="undefined"!=typeof window&&window===this?this:void 0!==e&&null!=e?e:this,s="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,a){e!=Array.prototype&&e!=Object.prototype&&(e[t]=a.value);};function n(){n=function(){},a.Symbol||(a.Symbol=r);}var o=0;function r(e){return "jscomp_symbol_"+(e||"")+o++}function i(){n();var e=a.Symbol.iterator;e||(e=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&s(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return l(this)}}),i=function(){};}function l(e){var t=0;return function(e){return i(),(e={next:e})[a.Symbol.iterator]=function(){return this},e}((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function c(e){i();var t=e[Symbol.iterator];return t?t.call(e):l(e)}function d(e){if(!(e instanceof Array)){e=c(e);for(var t,a=[];!(t=e.next()).done;)a.push(t.value);e=a;}return e}var u=0;var p="img script iframe link audio video source".split(" ");function h(e,t){for(var a=(e=c(e)).next();!a.done;a=e.next())if(a=a.value,t.includes(a.nodeName.toLowerCase())||h(a.children,t))return !0;return !1}function g(e,t){if(2<e.length)return performance.now();for(var a=[],s=(t=c(t)).next();!s.done;s=t.next())s=s.value,a.push({timestamp:s.start,type:"requestStart"}),a.push({timestamp:s.end,type:"requestEnd"});for(s=(t=c(e)).next();!s.done;s=t.next())a.push({timestamp:s.value,type:"requestStart"});for(a.sort((function(e,t){return e.timestamp-t.timestamp})),e=e.length,t=a.length-1;0<=t;t--)switch(s=a[t],s.type){case"requestStart":e--;break;case"requestEnd":if(2<++e)return s.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function m(e){e=e||{},this.w=!!e.useMutationObserver,this.u=e.minValue||null,e=window.__tti&&window.__tti.e;var t=window.__tti&&window.__tti.o;this.a=e?e.map((function(e){return {start:e.startTime,end:e.startTime+e.duration}})):[],t&&t.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,function(e,t){var a=XMLHttpRequest.prototype.send,s=u++;XMLHttpRequest.prototype.send=function(n){for(var o=[],r=0;r<arguments.length;++r)o[r-0]=arguments[r];var i=this;return e(s),this.addEventListener("readystatechange",(function(){4===i.readyState&&t(s);})),a.apply(this,o)};}(this.m.bind(this),this.l.bind(this)),function(e,t){var a=fetch;fetch=function(s){for(var n=[],o=0;o<arguments.length;++o)n[o-0]=arguments[o];return new Promise((function(s,o){var r=u++;e(r),a.apply(null,[].concat(d(n))).then((function(e){t(r),s(e);}),(function(e){t(e),o(e);}));}))};}(this.m.bind(this),this.l.bind(this)),function(e){e.c=new PerformanceObserver((function(t){for(var a=(t=c(t.getEntries())).next();!a.done;a=t.next())if("resource"===(a=a.value).entryType&&(e.b.push({start:a.fetchStart,end:a.responseEnd}),b(e,g(e.g,e.b)+5e3)),"longtask"===a.entryType){var s=a.startTime+a.duration;e.a.push({start:a.startTime,end:s}),b(e,s+5e3);}})),e.c.observe({entryTypes:["longtask","resource"]});}(this),this.w&&(this.h=function(e){var t=new MutationObserver((function(t){for(var a=(t=c(t)).next();!a.done;a=t.next())("childList"==(a=a.value).type&&h(a.addedNodes,p)||"attributes"==a.type&&p.includes(a.target.tagName.toLowerCase()))&&e(a);}));return t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),t}(this.B.bind(this)));}function f(e){e.i=!0;var t=0<e.a.length?e.a[e.a.length-1].end:0,a=g(e.g,e.b);b(e,Math.max(a+5e3,t));}function b(e,t){!e.i||e.v>t||(clearTimeout(e.j),e.j=setTimeout((function(){var t=performance.timing.navigationStart,a=g(e.g,e.b);t=(window.a&&window.a.A?1e3*window.a.A().C-t:0)||performance.timing.domContentLoadedEventEnd-t;if(e.u)var s=e.u;else performance.timing.domContentLoadedEventEnd?s=(s=performance.timing).domContentLoadedEventEnd-s.navigationStart:s=null;var n=performance.now();null===s&&b(e,Math.max(a+5e3,n+1e3));var o=e.a;5e3>n-a?a=null:a=5e3>n-(a=o.length?o[o.length-1].end:t)?null:Math.max(a,s),a&&(e.s(a),clearTimeout(e.j),e.i=!1,e.c&&e.c.disconnect(),e.h&&e.h.disconnect()),b(e,performance.now()+1e3);}),t-performance.now()),e.v=t);}m.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise((function(t){e.s=t,"complete"==document.readyState?f(e):window.addEventListener("load",(function(){f(e);}));}))},m.prototype.m=function(e){this.f.set(e,performance.now());},m.prototype.l=function(e){this.f.delete(e);},m.prototype.B=function(){b(this,performance.now()+5e3);},a.Object.defineProperties(m.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return [].concat(d(this.f.values()))}}});var y={getFirstConsistentlyInteractive:function(e){return e=e||{},"PerformanceLongTaskTiming"in window?new m(e).getFirstConsistentlyInteractive():Promise.resolve(null)}};e$1.exports?e$1.exports=y:window.ttiPolyfill=y;}();}));if(Dr(r),!document.location.pathname.endsWith("/options.html"))throw new Error("Options.ts shouldn't be imported outside options.html");const vn=new he("options"),Cn=new he("options"),wn=Ro.getState().global.config.signupDialogReloadThreshold;async function Sn(e){const t=new URL(window.location.href);for(const a of e)t.searchParams.delete(a);window.history.replaceState({},"",t.toString());}function xn(){return document.getElementById("toast-success")}function kn(){return document.getElementById("toast-info")}function En(){return document.getElementById("toast-error")}class In{constructor(){In.initSentry(),this.errorToast=document.getElementById("toast-error"),this.infoToast=document.getElementById("toast-info"),this.recoveryOverwriteDialog=document.getElementById("recovery-overwrite-dialog"),this.successToast=document.getElementById("toast-success"),document.getElementById("join-now-button")?.addEventListener("click",(()=>{ni({type:"signup.main-join"});})),document.addEventListener("reset",In.closeDialogOnDialogFormReset),document.getElementById("recovery-overwrite")?.addEventListener("click",(e=>this.showRecoveryOverwriteModal(e))),document.getElementById("recovery-choose-import")?.addEventListener("click",(e=>In.chooseImportRecovery(e))),document.getElementById("recovery-do-nothing")?.addEventListener("click",(e=>In.recoveryImportNothing(e))),this.recoveryOverwriteDialog.addEventListener("submit",(e=>this.importSnippetsFromSync(e))),document.querySelectorAll(".sign-up-button").forEach((e=>{e.addEventListener("click",(({target:e})=>{const t=e.hasAttribute("data-open-in-same-tab");In.signupPage(t);}));})),document.getElementById("sign-up-finish-button")?.addEventListener("click",In.finishSigningUp),document.querySelectorAll(".cancel-tag").forEach((e=>{e.addEventListener("click",(()=>{Ro.dispatch(Io());}));})),In.updateTimesReloaded(),In.maybeOpenChecklist(),In.updateLogoutToast(),In.maybeShowRecoveryOptions(),In.renderPreactApp(),In.processParams(),document.getElementById("csv-converter")?.addEventListener("click",(()=>ni({type:"ate_csvConverter"}))),document.getElementById("json-validator")?.addEventListener("click",(()=>ni({type:"ate_jsonValidator"}))),window.addEventListener("beforeunload",(e=>{const t=document.getElementById("snippets")?.querySelector('form[role="row"][data-is-dirty="true"], form[role="row"][data-is-in-conflict="true"]');t&&(e.preventDefault(),t.scrollIntoView({behavior:"smooth"}),e.returnValue="Discard changes to shortcuts?");})),re("prefillNewShortcut").subscribe((async e=>{null!=e&&(Ro.dispatch(_o({snippet:e})),te("prefillNewShortcut"));})),re("lastEditedSnippetBody").subscribe((async e=>{e&&Ro.dispatch(jo(e)),te("lastEditedSnippetBody");})),re("reshareCollectionId").subscribe((async e=>{if(!e)return;te("reshareCollectionId");const t=(await Xn("snippetCollections")??{})[e];t&&0!==t.snippetIds.length&&(Ro.dispatch(mo()),Ro.dispatch(yo(t.snippetIds)),Ro.dispatch(ot({shortcutIds:t.snippetIds,reshareCollectionId:e})));})),r.setDefaultLevel("info");}static get recoveryDialog(){return document.getElementById("recovery-dialog")}static showCreateOrEditTagModal(){const{tagToModify:e,selectedIds:t}=Ro.getState().optionsPage;if(e){const t=document.getElementById("edit-tag-dialog");document.getElementById("edit-tag-name").value=e.label,t.showModal();}else {const e=document.getElementById("create-tag-dialog"),a=document.getElementById("create-tag-name"),s=document.getElementById("create-tag");s.innerText=0===t?.length?"Create":"Create and apply",a.value="",e.showModal();}}static async updateTimesReloaded(){if((await Xn("userInfo"))?.email)return;const e=await Xn("notifications");e&&e.timesReloaded&&e.timesReloaded%wn>0&&Qn("notifications",{...e,timesReloaded:e.timesReloaded+1});}static async processParams(){const e=new URLSearchParams(window.location.search),t=e.get("dialog");if(t)switch(t){case"settings":Ro.dispatch(Je());break;case"shareApp":Ro.dispatch(et());break;case"topShortcut":{const t=e.get("shortcutId");t&&Ro.dispatch(tt({shortcutId:t}));break}default:r.error("Wrong dialog type:",t);}}static async maybeOpenChecklist(){const{showSignup:e}=Ro.getState().optionsPage,{referrals:t}=Ro.getState().global,a=await Xn("userInfo");if(!a||!a.featureFlags.checklistEnabled||e)return;await Bo;const{nextItem:s}=$p(a,t.length);Jo(s?{panel:{activeView:"checklist",isOpen:!0,views:{checklist:{expandedItems:[s]}}}}:{panel:{activeView:"checklist"}});}static async updateLogoutToast(){re("userInfo").subscribe((async e=>{e||(document.getElementById("toast-success").textContent="Log out successful");}));}static async maybeShowRecoveryOptions(){(await Gn("recoveryState")||{showRecoveryButton:!1,showRecoveryModal:!1}).showRecoveryModal&&In.showRecoveryModal();}static async renderPreactApp(){await Bo,Lt(mt(gn,null),document.querySelector("body"),document.getElementById("options-app"));}static closeDialogOnDialogFormReset(e){e.target instanceof HTMLFormElement&&"dialog"===e.target.method&&e.target.closest("dialog").close("");}static async showRecoveryModal(){ni({type:"ate_importRecoveryShow"});const e=Object.keys(Wn(await Hn())).length;for(const t of document.querySelectorAll(".recovered-num-shortcuts"))t.textContent=`${e}`;const t=Object.keys(await Cn.request("getSnippets")).length;for(const e of document.querySelectorAll(".current-num-shortcuts"))e.textContent=`${t}`;In.recoveryDialog.showModal();}showRecoveryOverwriteModal(e){this.recoveryOverwriteDialog.showModal();}static recoveryImportNothing(e){qn({showRecoveryButton:!0,showRecoveryModal:!1});}static async chooseImportRecovery(e){const t=await Hn();for(const[e,a]of Object.entries(Wn(t))){const t={trigger:e,body:a};Ro.dispatch(_o({snippet:t}));}ni({type:"ate_importRecoveryChoose"}),qn({showRecoveryButton:!0,showRecoveryModal:!1});}async importSnippetsFromSync(e){try{const e=await Hn(),t=Wn(e);await In.importSnippets(t,1);const a=Object.keys(t).map((e=>`${Fn}${e}`));await Kn("backedUpShortcuts",a),In.recoveryDialog.close(),ni({type:"ate_importRecoveryOverwrite"}),this.successToast.textContent="Success recovering shortcuts",qn({showRecoveryButton:!1,showRecoveryModal:!1});}catch(e){throw r.error("Error recovering shortcuts",e),this.errorToast.textContent="Error recovering shortcuts",new Error("Import error")}}static signupPage(e){ni({type:"ate_signin"}),e?window.location.href=Dn:Ht(Dn);}static finishSigningUp(){ni({type:"ate_signupDetails"}),Ht("https://www.getmagical.com/autotextexpander/signup-details");}static async importSnippets(e,t){const a=Object.keys(e),s=Object.values(await Cn.request("getSnippets")),n=Object.values(s).map((e=>e.trigger)),r=o.difference(n,a),i=Object.values(s).filter((e=>r.includes(e.trigger)&&e.id)).map((e=>e.id)),l=[];for(const[a,n]of Object.entries(e)){const e=Object.values(s).find((e=>a===e.trigger));l.push({...Bn(),id:e?.id||pe(),trigger:a,body:t<3?rn$1(nn$1(n)):n});}await vn.request("import",l,i);}static async recordTimeToInteractive(){let e;new PerformanceObserver((t=>{for(const a of t.getEntries())e=a.startTime-performance.timeOrigin;})).observe({type:"first-input",buffered:!0});const t=await yn.getFirstConsistentlyInteractive({buffered:!0}),a=!(!t||window.scrollY||"visible"!==document.visibilityState||e&&!(e>t));a&&t&&new URL(window.location.href).searchParams.has("perf-test")&&r.error("timeToInteractive:",t),ni({type:"options.open",timeToInteractive:a&&t?t:void 0});}static async initSentry(){const{sentryConfigs:e}=Ro.getState().global.config;jr(e,"options",{enableTracing:!0});}}new In,In.recordTimeToInteractive();

export { In as OptionsPage, En as getErrorToast, kn as getInfoToast, xn as getSuccessToast, Sn as updateOptionsUrlWithoutParams };
