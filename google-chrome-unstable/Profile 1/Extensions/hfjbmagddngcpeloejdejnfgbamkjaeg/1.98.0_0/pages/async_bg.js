"use strict";__filename="pages/async_bg.js",define(["require","exports"],function(n,e){var t,o,u,r,i,l,c,a,f,s,d,m,v,h,p,g,b,y,w,K,k,q,C,M;Object.defineProperty(e,"__esModule",{value:true}),e.fn=e.simulateClick=e.a=e.ii=e.c=e.fetch=e.import2=e.K=e.y=e.toggleReduceMotion=e.toggleDark=e.$$=e.$=e.an=e.m=e.ln=e.nn=e.Mt=e.dn=e.mn=e.vt=e.sn=e.OnSafari=e.OnEdge=e.OnFirefox=e.OnChrome=void 0,e.OnChrome=!0,e.OnFirefox=!!0,e.OnEdge=!!0,e.OnSafari=false,t=navigator.userAgentData,e.sn=(o=t&&(t.brands||t.uaList))?!!o.find(function(n){return n.brand.includes("Edge")||n.brand.includes("Microsoft")}):matchMedia("(-ms-high-contrast)").matches,e.vt=o?(u=o.find(function(n){return n.brand.includes("Chromium")}))?u.version:83:(k=navigator.userAgent.match(/\bChrom(?:e|ium)\/(\d+)/))?75==+k[1]&&matchMedia("(prefers-color-scheme)").matches?81:0|k[1]:998,e.mn=999,e.Mt=chrome,e.nn=new Promise(function(n){addEventListener("VimiumC",function t(){e.vt<55&&removeEventListener("VimiumC",t,{capture:true}),e.K(n)},{once:true,capture:true})}),r=4,i=new Map,l=null,c=null,a=Object.create(null),f=1,s=null,e.ln=-1,d=function(n){var e,t,o;if(false!==n){for(e=a[n.i],delete a[n.i],t=n.a,o=0;o<e.length;o++)e[o](t[o]);VApi&&s&&0===Object.keys(a).length&&p()}else alert("Can not send info to the background: not trusted")},m=function(){var n,e,t;for(n in s=null,l=[],c=[],a)for(t of(e=a[n],delete a[n],e))try{t(null)}catch(n){}l=c=null},v=function(n){var t,o,u,r,i;l&&(t=VApi,(o=l.length)>(n||1)?g(v.bind(null,o)):(t&&s&&0===Object.keys(a).length&&p(),0!==n?(u=f++,a[u]=c,c=null,(i=(r=e.Mt.extension.getBackgroundPage)&&r())&&i.onPagesReq?i.onPagesReq({i:u,q:l}).then(d):t?t.r[0](37,{i:u,q:l},d):(s||((s=e.Mt.runtime.connect({name:"64"})).onMessage.addListener(d),s.onDisconnect.addListener(m)),s.postMessage({H:37,i:u,q:l})),l=null):l=c=null))},e.m=function(n,e){return new Promise(function(t){l||h(),l.push({n:n,q:void 0!==e?e:null}),c.push(t)})},e.an=h=function(){l||(l=[],c=[],g(v))},p=function(){var n=s;s=null,n&&(n.onDisconnect.removeListener(m),n.onMessage.removeListener(d),n.disconnect())},g=function(n){Promise.resolve().then(n)},e.$=function(n){return document.querySelector(n)},e.$$=function(n,t){var o=(t||document).querySelectorAll(n);return e.vt<51?[].slice.call(o):o},e.toggleDark=function(n){var e,t=document.head.querySelector("meta[name=color-scheme]"),o=2===n?"light dark":1===n?"dark":"light";t.content!==o&&(t.content=o,(e=document.documentElement.classList).toggle("no-dark",!n),e.toggle("dark",1===n))},e.toggleReduceMotion=function(n){document.documentElement.classList.toggle("less-motion",n)},e.K=(q=function(){var n,e=C.length;for(n=0;n<e;n++)C[n]();C.length>e?(C.splice(0,e),g(q)):C.length=0},C=[],e.y=function(n,e){7==(r=(r|n)&~(e||0))&&g(q)},function(n,e){C.length<=0&&7===r&&g(q),9===e?C.unshift(n):C.push(e?n.bind(null,e):n)}),e.import2=function(n){return define([n])},e.fetch=function(n,e){return(0,globalThis.fetch)(n,e)},e.c=function(n,e){var t=i.get(n);return null!=e&&t&&(t=t.replace(/\$\d/g,function(n){return e[+n[1]-1]})),t},b=function(n,e){return n&&n.split(" ").reduce(function(n,t){return n||(t.includes("=")?t.startsWith(e)?t.slice(e.length+1):n:t)},"")},e.ii=e.Mt.i18n.getMessage,y=location.pathname.replace("/pages/","").split(".")[0],w=e.ii("lang1"),e.a=b(e.ii("i18n"),y)||w||"en",Promise.all(e.a.split(",").map(function(n){var t="/i18n/".concat(n,"/").concat("show"===y?"popup":y,".json");return e.fetch(t).then(function(n){return n.json()}).catch(function(n){return console.log("Can not load the language file:",t,":",n),null})})).then(function(n){var t,o,u=i;for(t of n.reverse())if(t)for(o in t)u.set(o,t[o]);e.y(2)}),M=function(n,e){return new Promise(function(t){var o=t.bind(0,void 0),u=n.call(e),r=function(n){var e=u.next(n);Promise.resolve(e.value).then(e.done?t:r,o)};r()})},globalThis.__awaiter=function(n,e,t,o){return M(o,n)},e.vt>75&&e.Mt.storage.local.get("autoDarkMode",function(n){var t=n&&n.autoDarkMode;return(false===t||1===t)&&e.toggleDark(t?1:0),e.Mt.runtime.lastError}),w&&"popup"!==y&&(K=e.ii("v"+y))&&(document.title="Vimium C "+K),"options"===y&&e.nn.then(function(){VApi.r[0](37,{i:1,q:[{n:26,q:null}]},function(n){false!==n&&(e.ln=n.a[0])})}),e.simulateClick=function(n,e){var t;return e=e||{ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},t=new MouseEvent("click",{bubbles:true,cancelable:true,composed:!0,view:window,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:0,buttons:1,relatedTarget:null}),n.dispatchEvent(t)};e.fn=function(n){return n.shiftKey},"undefined"==typeof VApi&&(globalThis.VApi=void 0)});