"use strict";__filename="pages/options_wnd.js",define(["require","exports","./async_bg","./options_base","./options_defs","./options_permissions"],function(n,t,i,e,o,u){var r,a,c,s;Object.defineProperty(t,"__esModule",{value:true}),t.loadChecker=t.clear_delayed_task=t.advancedOptBtn=t.delayed_task=void 0,t.advancedOptBtn=i.$("#advancedOptionsButton"),r=false,a=function(){t.delayed_task=null},t.clear_delayed_task=a,i.y(8),i.K(e.showI18n),e.n&&i.K(e.n),i.K(function(n){n.textContent=u.manifest.version_name||u.manifest.version},i.$(".version")),o.saveBtn.onclick=function(n){if(false===n){var t=e.s.I;e.s.I=[],o.saveBtn.disabled=true,o.saveBtn.firstChild.data=e.t("o115_3"),o.exportBtn.disabled=false,o.savedStatus(false),window.onbeforeunload=null,0!==t.length&&setTimeout(function(n){i.m(4,n.map(function(n){return e.r.b[n]}))},100,t)}else e.s.At().then(function(n){n&&o.saveBtn.onclick(false)})},c=function(){var n,a,c,s,f,l,d;for(c in t.advancedOptBtn.onclick=function(n,t){var o=this,u=i.$("#advancedOptions"),a=null,c=function(){return a=e.r.g("showAdvancedOptions")};null!=n||"hash"===t&&false===c()?e.r.k("showAdvancedOptions",r=!r):r=null!=a?a:c(),i.K(function(){u.previousElementSibling.style.display=u.style.display=r?"":"none";var n=r?"Hide":"Show";o.firstChild.data=e.t(n)||n,o.setAttribute("aria-checked",""+r)},9)},t.advancedOptBtn.onclick(null,true),e.s.T=false,e.s.i)e.s.i[c].R();for(e.s.i.exclusionRules.w.length>0&&i.K(function(n){n.style.visibility=""},i.$("#exclusionToolbar")),s=(a=i.$$("[data-check]")).length;0<=--s;)(n=a[s]).addEventListener(n.dataset.check||"input",t.loadChecker);for(document.addEventListener("keyup",function(n){var t=n.target,e=n.keyCode;if(13===e){if(t instanceof HTMLAnchorElement)t.hasAttribute("href")||setTimeout(function(n){i.simulateClick(n),n.blur()},0,t);else if((n.ctrlKey||n.metaKey)&&(t.blur&&t.blur(),o.savedStatus()))return o.saveBtn.onclick()}else{if(32!==e)return;t instanceof HTMLSpanElement&&t.parentElement instanceof HTMLLabelElement&&(n.preventDefault(),i.simulateClick(t.parentElement.control))}}),f=function(){var n,t,e=i.$("#"+this.dataset.autoResize),o=e.scrollHeight,u=e.scrollWidth,r=u-e.clientWidth;o<=e.clientHeight&&r<=0||(n=Math.max(Math.min(innerWidth,1024)-120,550),e.style.maxWidth=u>n?n+"px":"",e.style.height=e.style.width="",t=e.offsetHeight-e.clientHeight,o+=t=(r=u-e.clientWidth)>0?Math.max(26,t):t+18,r>0&&(e.style.width=e.offsetWidth+r+4+"px"),e.style.height=o+"px")},s=(a=i.$$("[data-auto-resize]")).length;0<=--s;)a[s].onclick=f;for(f=function(n){var e=this.dataset.delay,o=null;"continue"!==e&&n&&n.preventDefault(),"event"===e&&(o=n||null),t.delayed_task=["#"+this.id,o],"complete"!==document.readyState?window.addEventListener("load",function n(t){t.target===document&&(window.removeEventListener("load",n),i.import2("./options_ext.js"))}):i.import2("./options_ext.js")},s=(a=i.$$("[data-delay]")).length;0<=--s;)a[s].onclick=f;if(i.vt<53)for(f=function(n){n.target===this&&(n.preventDefault(),getSelection().selectAllChildren(this))},s=(a=i.$$(".sel-all")).length;0<=--s;)a[s].onmousedown=f;for((a=i.$$("[data-permission]")).length>0&&(function(n){function t(){var n,t=this.querySelector("[data-permission]");this.onclick=null,t&&(t.placeholder=e.t("lackPermission",[(n=t.dataset.permission)?': "'.concat(n,'"'):""]))}var o,r=u.manifest.permissions||[],a=function(o){var a,c,s=n[o],f=s.dataset.permission;if("C"===f[0]){if(i.vt>=parseInt(f.slice(1)))return"continue";if("."===(c=f.split(",",2)[1]||",")[0]?null!=window[c.slice(1)]:"("===c[0]&&matchMedia(c.slice(1,-1)))return"continue";a=["beforeChromium",[f.slice(1).split(",",1)[0]]]}else{if(f in u.manifest||r.includes(f))return"continue";a=["lackPermission",[f?":\n* "+f:""]]}i.K(function(n){n.disabled=true;var i=e.t("invalidOption",[e.t(a[0],a[1])]);n instanceof HTMLInputElement&&"checkbox"===n.type?(n.nextElementSibling.tabIndex=-1,(n=n.parentElement).title=i):(n.value="",n.title=i,n.parentElement.onclick=t,n instanceof HTMLSpanElement&&(n.style.textDecoration="line-through"))},s)};for(o=n.length;0<=--o;)a(o)})(a),i.K(function(){setTimeout(function(){var n,t=i.$$("[data-href]"),e=function(n){var e=t[n];i.m(10,[e.dataset.href,-1]).then(function(n){var t=n[0];e.removeAttribute("data-href"),e.href=t})};for(n=t.length;0<=--n;)e(n);i.m(12).then(function(n){"?"!==n&&i.K(function(n){return n[0].textContent=n[1]},[i.$("#questionShortcut"),n])})},100)}),n=i.$("#openExtensionsPage"),i.vt<65&&i.K(function(n){n.href="chrome://extensions/configureCommands"},n),n.onclick=function(n){n.preventDefault(),i.m(15,{u:this.href,p:true})},i.K(function(n){var t=n.children[1],i=e.t("NewTabAdapter");t.title=i+" - "+e.t("webstore")},i.$("#chromeExtVomnibar")),a=i.$$(".ref-text"),l=function(n){r||i.$("#advancedOptionsButton").onclick(null),n.preventDefault();var t=e.s.i[this.getAttribute("for")].S.nextElementSibling;i.vt<61?t.scrollIntoViewIfNeeded():t.scrollIntoView({block:"center"}),t.focus(),VApi&&VApi.x(t.parentElement.parentElement)},d=function(n){var t=e.s.i[a[n].getAttribute("for")],o=t.M;t.M=function(){return i.K(function(n){n.textContent=e.t(t.F()>1?"o145_2":"o144")},i.$("#".concat(t.S.id,"Status"))),o.call(t)},a[n].onclick=l,t.S.addEventListener("change",t.M,true)},s=a.length;0<=--s;)d(s)},s=function(){var n,t,u,r,a;for(n in c(),c=s=null,e.r.l||i.K(function(n){n.textContent="Cmd"},i.$("#Ctrl")),e.s.i)e.s.i[n].M();i.K(function(){document.documentElement.classList.remove("loading")}),i.nn.then(i.an),location.hash&&i.K(window.onhashchange),i.y(0,8),e.s.i.keyMappings.M=function(){return i.m(7).then(o.onKeyMappingsError)},t=matchMedia("(prefers-color-scheme: dark)"),u=function(){r.O&&i.m(11),setTimeout(a,34)},a=function(){var n,e,o,u,a,c,s=r.F(),f=2===s?!!t&&t.matches:1===s;if(VApi&&VApi.z){if(n=VApi.y().r)for(e of i.vt<51?[].slice.call(n.children):n.children)"style"!==e.localName&&(e.classList.toggle("D",f),"iframe"===(e=e.firstElementChild||e).localName&&(o=e.classList.contains("Find"),(a=(u=e.contentDocument).querySelector("style#dark"))&&a.sheet&&(a.sheet.disabled=!f),u.body.classList.toggle(o?"D":"has-dark",f),o&&(c=VApi.y().f)&&c.parentElement.classList.toggle("D",f)));i.m(3,{key:"d",val:f}).then(function(n){VApi.z.d=n})}i.toggleDark(f?2===s?2:1:0)},(r=e.s.i.autoDarkMode).M=u,i.vt>75?i.K(function(){2===r.w&&i.nn.then(u),t.onchange=u}):t=null},e.s.i.userDefinedCss.S.addEventListener("input",e.h(function(){var n,t,o,u,r,a=e.s.i.userDefinedCss,c=a.S.classList.contains("debugging");(!a.O||c)&&VApi&&VApi.z&&(n=a.F(),t=n===a.w,o=i.m(8,[n,i.ln]),u=VApi.y(),r=u.r,o.then(function(n){var i,o,u;a.S.classList.toggle("debugging",!t),VApi.t({k:r||t?0:1,t:e.t("livePreview")||"Live preview CSS\u2026",H:n.ui,f:n.find}),(o=(i=r&&r.querySelector("iframe.Omnibar"))&&i.contentDocument)&&((u=o.querySelector("style.debugged")||o.querySelector("style#custom"))||((u=o.createElement("style")).type="text/css",u.id="custom"),u.parentNode||o.head.appendChild(u),u.classList.add("debugged"),u.textContent=(t?"\n":"\n.transparent { opacity: 1; }\n")+(n.omni&&n.omni+"\n"||""))}))},1200,null,0)),i.$("#importButton").onclick=function(){var n=i.$("#importOptions");n.onchange?n.onchange(null):i.simulateClick(i.$("#settingsFile"))},i.K(function(n){var t,o,u,r,a,c=e.r.f,s=i.dn;s||(u=(o=((t=navigator.userAgentData)&&(t.brands||t.uaList)||[]).filter(function(n){return n.version===i.vt&&"Chromium"!==n.brand&&!" ".concat(n.brand," ").includes(" Not ")})).find(function(n){return n.brand.includes("Edge")})||o[0],r=i.sn?"MS Edge":"",s=u?u.brand:t?r||"Chromium":(/\bChromium\b/.exec(navigator.userAgent)||[""])[0]||r||"Chrome"),n.textContent=s+" "+i.vt+e.t("comma")+e.t("NS")+(e.t(c)||c[0].toUpperCase()+c.slice(1)),i.sn&&((a=i.$("#openExtensionsPage")).textContent=a.href="edge://extensions/shortcuts")},i.$("#browserName")),t.loadChecker=function(){i.import2("./options_checker.js")},document.addEventListener("keydown",function(n){var t,e,o,u,r;if(32===n.keyCode)"span"===(r=n.target).localName&&"label"===r.parentElement.localName&&n.preventDefault();else{if(!VApi||!VApi.z||"input textarea".includes(document.activeElement.localName))return;"a-f12"===(t=VApi.r[3]({c:" ",e:n,i:n.keyCode},10))?(e=i.$("#importOptions"),o=e.selectedIndex,u=function(){e.onchange&&e.onchange(null),e.selectedIndex=o},i.$("#recommendedSettings").selected=true,null!=e.onchange?u():setTimeout(u,100)&&e.click()):"?"===t&&i.$("#showCommands").click()}}),window.onhashchange=function(){var n,t,e=location.hash;if((e=e.slice("!"===e[1]?2:1))&&/^[a-z][a-z\d_-]*$/i.test(e))if(n=i.$('[data-hash="'.concat(e,'"]')))n.onclick&&n.onclick(null,"hash");else if(n=i.$("#"+e)){if(n.dataset.model&&n.classList.add("highlight"),t=function(t){t&&t.target!==window||(window.onload&&(window.onload=null,window.scrollTo(0,0)),n.scrollIntoViewIfNeeded())},"complete"===document.readyState)return t();window.scrollTo(0,0),window.onload=t}},e.r.v().then(s),document.addEventListener("click",function n(){var t=VApi,e=t&&t.y();e&&e.r&&(document.removeEventListener("click",n,true),e.r.addEventListener("click",function(n){var t,i=n.target;VApi&&i.classList.contains("HelpCommandName")&&(t=i.textContent.slice(1,-1),VApi.p({H:16,s:t}))},true),document.addEventListener("click",function(n){var t,e,o,u;"a"!==n.target.localName||!n.ctrlKey&&!n.metaKey||i.ln<-1||(o=(e=(t=VApi)&&t.b)&&e.$())&&o.a&&o.k&&null===o.k.c&&(u=-17&o.m)<32&&2&u&&!(1&u)&&setTimeout(function(){i.ln>=0&&(i.Mt.tabs?i.Mt.tabs.update(i.ln,{active:true},function(){}):i.m(25,{module:"tabs",name:"update",args:[i.ln,{active:true}]}))},0)}))},true)});